import{_ as O,L as U,e as f,M as B}from"../../index-GVMBwoSB.js";import{F as M}from"./index-BL197tQK.js";import{r as s,w as V,L as n,M as w,a8 as N,j as h,Q as I,V as d,P,u as x,a3 as S,a4 as A}from"./vue-chunks-CX0PHdkT.js";import{P as J}from"./PlusOutlined-sorM8mvn.js";import{_ as G}from"./index-DTami1oY.js";const R=t=>(S("data-v-82e98fe9"),t=t(),A(),t),z={class:"avatar-uploader"},D=["src"],E=R(()=>d("div",{class:"ant-upload-text"},"上传照片",-1)),Q=["src"],T={__name:"avatar-input",props:{value:{type:String,default:""}},emits:["update:value","change"],setup(t,{emit:y}){function v(e){return new Promise((o,l)=>{const a=new FileReader;a.readAsDataURL(e),a.onload=()=>o(a.result),a.onerror=p=>l(p)})}const m=y,C=t,r=s([]),g=s(!1),i=s("");V(()=>C.value,e=>{i.value=e},{immediate:!0});const L=M.useInjectFormItemContext(),b=()=>{let e={imageUrl:i.value,file:r.value[0].originFileObj};m("change",e),m("update:value",e.imageUrl),L.onFieldChange()},j=e=>e.type==="image/jpeg"||e.type==="image/png"?e.size/1024<100?(r.value=[e],v(e).then(a=>{i.value=a,g.value=!1,b()}),!1):(f.error("知识库封面图片大小不能超过100kb"),!1):(f.error("知识库封面只支持JPG、PNG格式的图片"),!1),u=s(!1),_=s(""),c=s(""),k=()=>{u.value=!1,c.value=""},F=async e=>{!e.url&&!e.preview&&(e.preview=await v(e.originFileObj)),_.value=e.url||e.preview,u.value=!0,c.value=e.name||e.url.substring(e.url.lastIndexOf("/")+1)};return(e,o)=>{const l=G,a=B;return n(),w("div",z,[t.value?(n(),w("img",{key:0,class:"avatar",src:t.value,alt:"avatar"},null,8,D)):N("",!0),h(l,{class:"upload-upload","file-list":r.value,"onUpdate:fileList":o[0]||(o[0]=p=>r.value=p),"list-type":"picture-card","show-upload-list":!1,"before-upload":j,accept:".jpg,.png,.jpeg",onPreview:F},{default:I(()=>[d("div",null,[g.value?(n(),P(x(U),{key:0})):(n(),P(x(J),{key:1})),E])]),_:1},8,["file-list"]),h(a,{open:u.value,title:c.value,footer:null,onCancel:k},{default:I(()=>[d("img",{alt:"example",style:{width:"100%"},src:_.value},null,8,Q)]),_:1},8,["open","title"])])}}},Y=O(T,[["__scopeId","data-v-82e98fe9"]]);export{Y as A};
