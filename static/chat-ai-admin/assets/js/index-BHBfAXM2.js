import{r as d,A as U,L as R,M as j,j as i,Q as k,V as s,U as M,u as l,a9 as O,a6 as V,Y as A,a3 as $,a4 as q}from"./vue-chunks-C0QQWOCx.js";import{_ as L,l as F,e as P,M as J,a as N,b as D}from"../../index-0jhxEUZS.js";import{v as G}from"./validate-8MtiUsxW.js";import{F as I,_ as H}from"./index-CRVpDJ1f.js";import{_ as T}from"./Password-D0V1lqaH.js";import{_ as z}from"./index-CzVWingc.js";import"./axios-Cm0UX6qg.js";import"./qs-CnxcMLjH.js";import"./crypto-js-C2SrYqGA.js";import"./dayjs-CsGPDCY7.js";import"./colors-mU-75_cq.js";import"./ResizeObserver.es-B1PUzC5B.js";import"./isPlainObject-DgCxKo0N.js";import"./responsiveObserve-Cvd8WiWW.js";import"./collapseMotion-BOXZQl9Y.js";import"./index-DMH-zawU.js";import"./QuestionCircleOutlined-BDfA4Qtk.js";import"./FormItemContext-BtHm9ijx.js";import"./Input-C2joc_0K.js";import"./statusUtils-BN1jNO5O.js";import"./inputProps-DKMe6fry.js";import"./index-CIBVllRY.js";import"./partition-Cp0_1Ufx.js";import"./CheckOutlined-DjzOOMrf.js";import"./useRefs-DDwzsqEq.js";const E="data:image/svg+xml,%3csvg%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%2040%2040'%20class='design-iconfont'%3e%3crect%20width='40'%20height='40'%20rx='20'%20fill='%232475FC'/%3e%3cpath%20d='M10.0835%2030.5H31.0835'%20stroke='%23fff'%20stroke-width='2.275'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3cpath%20d='M12.4165%2021.5867V25.8333H16.6848L28.7498%2013.763L24.4886%209.5L12.4165%2021.5867Z'%20stroke='%23fff'%20stroke-width='2.275'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3c/svg%3e",Q={class:"form-box"},Y={__name:"modify-account",emits:["ok"],setup(v,{expose:c,emit:p}){const h=p,y=I.useForm,n=d(!1),u=d("修改登录密码"),o=U({password:"",check_password:"",old_password:"",id:""}),x=U({old_password:[{message:"请输入原始密码",required:!0}],password:[{message:"请输入登录密码",required:!0},{validator:async(a,e)=>!G(e)&&e?Promise.reject("密码必须包含字母、数字或者字符中的两种，6-32位"):e==o.old_password?Promise.reject("原密码不能和新密码一致"):Promise.resolve()}],check_password:[{message:"请输入确认密码",required:!0},{validator:async(a,e)=>e!=o.password&&e?Promise.reject("两次输入的密码不一致"):Promise.resolve()}]}),{resetFields:_,validate:g,validateInfos:m}=y(o,x),w=a=>{n.value=!0,_(),o.password="",o.check_password="",o.old_password="",o.id=a.user_id},t=()=>{g().then(()=>{F({...O(o)}).then(a=>{P.success("修改成功"),n.value=!1,h("ok")})})};return c({open:w}),(a,e)=>{const r=T,b=H,B=I,C=J;return R(),j("div",null,[i(C,{open:n.value,"onUpdate:open":e[3]||(e[3]=f=>n.value=f),title:u.value,onOk:t,width:"476px"},{default:k(()=>[s("div",Q,[i(B,{layout:"vertical"},{default:k(()=>[i(b,M({label:"原密码"},l(m).old_password),{default:k(()=>[i(r,{value:o.old_password,"onUpdate:value":e[0]||(e[0]=f=>o.old_password=f),placeholder:"请输入原始密码校验"},null,8,["value"])]),_:1},16),i(b,M({label:"登录密码"},l(m).password),{default:k(()=>[i(r,{value:o.password,"onUpdate:value":e[1]||(e[1]=f=>o.password=f),placeholder:"密码必须包含字母、数字或者字符中的两种，6-32位"},null,8,["value"])]),_:1},16),i(b,M({label:"确认密码"},l(m).check_password),{default:k(()=>[i(r,{value:o.check_password,"onUpdate:value":e[2]||(e[2]=f=>o.check_password=f),placeholder:"请重新输入密码"},null,8,["value"])]),_:1},16)]),_:1})])]),_:1},8,["open","title"])])}}},Z=L(Y,[["__scopeId","data-v-cb17ec91"]]),K={class:"upload-box"},W={__name:"modify-avatar",emits:["ok"],setup(v,{expose:c,emit:p}){const h=p;function y(t){return new Promise((a,e)=>{const r=new FileReader;r.readAsDataURL(t),r.onload=()=>a(r.result),r.onerror=b=>e(b)})}const n=d([]),u=d(""),o=t=>t.type==="image/jpeg"||t.type==="image/png"?t.size/1024<1024?(n.value=[t],y(t).then(r=>{u.value=r,x()}),!1):(P.error("成员头像图片大小不能超过1M"),!1):(P.error("机器人头像只支持JPG、PNG格式的图片"),!1),x=()=>{let t={imageUrl:u.value,file:n.value[0].originFileObj};w(t)};d("修改登录密码");const _=U({id:""}),g=d(null),m=t=>{_.id=t.user_id,g.value.click()},w=t=>{F({...O(_),avatar:t.file}).then(a=>{P.success("修改成功"),h("ok",t.imageUrl)})};return c({setAvatar:m}),(t,a)=>{const e=z;return R(),j("div",K,[i(e,{"file-list":n.value,"onUpdate:fileList":a[0]||(a[0]=r=>n.value=r),"list-type":"picture-card","show-upload-list":!1,"before-upload":o,accept:".jpg,.png,.jpeg"},{default:k(()=>[s("div",{ref_key:"uploadBtnRef",ref:g},"修改头像",512)]),_:1},8,["file-list"])])}}},X=L(W,[["__scopeId","data-v-f5e61674"]]),S=v=>($("data-v-c0eaeb88"),v=v(),q(),v),ee={class:"user-account"},se={class:"page-title"},oe={class:"user-avatar-box"},te=["src"],ae=S(()=>s("img",{class:"change-btn",src:E,alt:"",srcset:""},null,-1)),re=[ae],ne={class:"user-info-items"},ie={class:"user-info-item"},le={class:"item-left"},ce={class:"item-label"},de={class:"item-value"},pe=S(()=>s("div",{class:"item-right"},null,-1)),ue={class:"user-info-item"},_e={class:"item-left"},me={class:"item-label"},fe=S(()=>s("span",{class:"item-value"},"**************",-1)),ve={__name:"index",setup(v){const{t:c}=D(),p=N(),{userInfo:h,avatar:y,user_name:n}=V(p),u=d(null),o=()=>{u.value.open(h.value)},x=()=>{p.reset(!0)},_=d(null),g=()=>{_.value.setAvatar(h.value)},m=w=>{p.setAvatar(w)};return(w,t)=>(R(),j("div",ee,[s("div",se,A(l(c)("views.user.account.accountSettings")),1),s("div",oe,[s("img",{class:"user-avatar",src:l(y),alt:""},null,8,te),s("span",{class:"change-avatar",onClick:g},re)]),s("div",ne,[s("div",ie,[s("div",le,[s("span",ce,A(l(c)("views.user.account.loginAccount")),1),s("span",de,A(l(n)),1)]),pe]),s("div",ue,[s("div",_e,[s("span",me,A(l(c)("views.user.account.accountPassword")),1),fe]),s("div",{class:"item-right",onClick:o},[s("a",null,A(l(c)("common.change")),1)])])]),i(Z,{onOk:x,ref_key:"modifyAccountRef",ref:u},null,512),i(X,{onOk:m,ref_key:"modifyAvatarRef",ref:_},null,512)]))}},De=L(ve,[["__scopeId","data-v-c0eaeb88"]]);export{De as default};
