import{L as C,M as w,V as t,j as o,u as $,a8 as I,F as K,a1 as j,Y as F,a7 as S,Q as p,X as J,a2 as Q,a3 as P,a4 as R,r as L,$ as z,A as H,v as Y,P as G,U as D,b as X}from"./vue-chunks-CX0PHdkT.js";import{_ as T,M as U,e as O,bs as V,bt as B,d as W,bu as e2,E as t2}from"../../index-GVMBwoSB.js";import{_ as a2,M as o2}from"./index-BD0PNgcQ.js";import"./index-BD0dTjKV.js";import{D as s2}from"./dropdown-DGCGRXRs.js";import{P as i2}from"./PlusCircleOutlined-BNGNAApW.js";import{M as l2}from"./MoreOutlined-Bb7qc7Bp.js";import{_ as n2}from"./index-3QeQOpaK.js";import{R as E}from"./RightOutlined-Ctsl4k5I.js";import{c as r2,g as d2,d as c2}from"./index-VltaZJWM.js";import{A as p2}from"./avatar-input-DlQSi_-P.js";import{t as _2}from"./validate-8MtiUsxW.js";import{F as Z,_ as u2}from"./index-BL197tQK.js";import"./index-CKa5RZod.js";import{I as m2}from"./Input--aGP1T3B.js";import{_ as f2}from"./TextArea-DeS198JN.js";import{T as v2,_ as y2}from"./index-DS7lFzRW.js";import"./axios-Cm0UX6qg.js";import"./qs-D52wVmk8.js";import"./crypto-js-ZYyBUTQg.js";import"./dayjs-DItM2b4N.js";import"./shallowequal-BtoafKsn.js";import"./colors-D_W7fn18.js";import"./ResizeObserver.es-B1PUzC5B.js";import"./collapseMotion-7Vnsd4b5.js";import"./slide-9COri5Ta.js";import"./index-CZ0E7pKU.js";import"./Dropdown-1ablIDCT.js";import"./move-DRhCXx5X.js";import"./PlusOutlined-sorM8mvn.js";import"./index-DTami1oY.js";import"./partition-B-kgZtUf.js";import"./Password-DduaVHe6.js";import"./inputProps-BUZdA0Zp.js";import"./CheckOutlined-DWxGZyjB.js";import"./useRefs-DaOtXq3f.js";import"./FormItemContext-2KmsKwBN.js";import"./isPlainObject-BNcE28c5.js";import"./responsiveObserve-CXBgjl43.js";import"./QuestionCircleOutlined-BtZ-HKyh.js";import"./index-DaXP6XK8.js";import"./Search-DaeGz4LJ.js";import"./SearchOutlined-DS22VXIZ.js";import"./statusUtils-BFiV3r53.js";import"./pick-K49Wrubl.js";import"./isMobile-D_4OiXLP.js";const C2=n=>(P("data-v-dc2b9b68"),n=n(),R(),n),b2={class:"list-box"},h2={key:0,class:"list-item-wrapper"},g2=C2(()=>t("span",{class:"add-library-text"},"新增知识库",-1)),w2=["onClick"],k2={class:"item-header"},x2=["src"],L2={class:"library-title"},$2=["onClick"],A2=["onClick"],F2={class:"item-body"},M2={class:"library-type"},I2={key:0,class:"type-tag"},S2={key:1,class:"type-tag"},T2={key:2,class:"type-tag"},q2={class:"library-desc"},D2={class:"library-size"},O2={class:"file-size"},V2={__name:"index",props:{list:{type:Array,default:()=>[]},showCreate:{type:Boolean,default:!0}},emits:["add","edit","delete"],setup(n,{emit:k}){const b=k,_=n,u=m=>{b("edit",m)},v=m=>{b("add",m)},e=m=>{b("delete",m)};return(m,y)=>{const l=a2,f=o2,h=s2,g=n2;return C(),w("div",b2,[_.showCreate?(C(),w("div",h2,[t("div",{class:"list-item add-library",onClick:v},[o($(i2),{class:"add-library-icon"}),g2])])):I("",!0),(C(!0),w(K,null,j(_.list,i=>(C(),w("div",{class:"list-item-wrapper",key:i.id},[t("div",{class:"list-item",onClick:S(A=>u(i),["stop"])},[t("div",k2,[t("img",{class:"library-icon",src:i.avatar,alt:""},null,8,x2),t("div",L2,F(i.library_name),1),t("span",{class:"item-action",onClick:y[1]||(y[1]=S(()=>{},["stop"]))},[o(h,null,{overlay:p(()=>[o(f,null,{default:p(()=>[o(l,null,{default:p(()=>[t("a",{href:"javascript:;",onClick:S(A=>u(i),["stop"])},"管 理",8,$2)]),_:2},1024),o(l,null,{default:p(()=>[t("a",{class:"delete-text-color",href:"javascript:;",onClick:A=>e(i)},"删 除",8,A2)]),_:2},1024)]),_:2},1024)]),default:p(()=>[t("span",{class:"menu-btn",onClick:y[0]||(y[0]=S(()=>{},["prevent"]))},[o($(l2))])]),_:2},1024)])]),t("div",F2,[t("div",M2,[i.type==0?(C(),w("span",I2,"普通知识库")):I("",!0),i.type==1?(C(),w("span",S2,"对外知识库")):I("",!0),i.type==2?(C(),w("span",T2,"问答知识库")):I("",!0),o(g,null,{title:p(()=>[J(F(i.graph_switch==0?"未":"已")+"开启知识图谱生成",1)]),default:p(()=>[t("span",{class:Q(["type-tag graph-tag",{"gray-tag":i.graph_switch==0}])},"Graph",2)]),_:2},1024)]),t("div",q2,F(i.library_intro),1)]),t("div",D2,[t("span",null,"文档数："+F(i.file_total),1),t("span",O2,"文档大小："+F(i.file_size_str),1)])],8,w2)]))),128))])}}},B2=T(V2,[["__scopeId","data-v-dc2b9b68"]]),P2="data:image/svg+xml,%3csvg%20width='64'%20height='64'%20viewBox='0%200%2064%2064'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M29.8066%2055.3034C14.0866%2051.3489%2011.0624%2045.5975%2015.5685%2027.6849C20.074%209.77234%2025.4347%206.23271%2041.1546%2010.1872C56.8746%2014.1417%2059.8378%2019.7747%2055.3323%2037.6873C50.8267%2055.5999%2045.5265%2059.2579%2029.8059%2055.3034H29.8066Z'%20fill='%232475FC'/%3e%3cpath%20d='M27.6401%2056.8699C9.97054%2056.8699%205.24487%2051.5938%205.24487%2031.46C5.24487%2011.3261%209.97054%206.15887%2027.6401%206.15887C45.3096%206.15887%2049.9398%2011.3261%2049.9398%2031.46C49.9398%2051.5938%2045.3096%2056.8699%2027.6401%2056.8699Z'%20fill='%232CAAFF'/%3e%3cpath%20d='M38.7639%2045.5143H36.8936C36.3373%2045.5143%2035.8577%2045.4677%2035.4549%2045.3743C35.052%2045.281%2034.7067%2045.1363%2034.419%2044.9403C34.1313%2044.7443%2033.8867%2044.497%2033.6853%2044.1983C33.4838%2043.8997%2033.2968%2043.5543%2033.1242%2043.1623C32.8364%2042.453%2032.5727%2041.809%2032.3329%2041.2303C32.0931%2040.6517%2031.8869%2040.1477%2031.7142%2039.7183C31.5032%2039.233%2031.3114%2038.785%2031.1388%2038.3743H23.974C23.8397%2038.8037%2023.6767%2039.2703%2023.4849%2039.7743C23.3314%2040.2037%2023.13%2040.7217%2022.8806%2041.3283C22.6312%2041.935%2022.3435%2042.593%2022.0174%2043.3023C21.6337%2044.1423%2021.1925%2044.721%2020.6938%2045.0383C20.195%2045.3557%2019.6291%2045.5143%2018.9961%2045.5143H17.0107C16.1667%2045.5143%2015.596%2045.3323%2015.2986%2044.9683C15.0013%2044.6043%2015.0253%2043.9837%2015.3706%2043.1063C15.7159%2042.2663%2016.1187%2041.277%2016.5791%2040.1383C17.0395%2038.9997%2017.5286%2037.791%2018.0466%2036.5123C18.5645%2035.2337%2019.1016%2033.9223%2019.6579%2032.5783C20.2142%2031.2343%2020.7513%2029.9183%2021.2693%2028.6303C22.497%2025.625%2023.7822%2022.4983%2025.125%2019.2503C25.2593%2018.933%2025.4319%2018.6437%2025.6429%2018.3823C25.8347%2018.177%2026.0889%2017.981%2026.4054%2017.7943C26.7219%2017.6077%2027.12%2017.5143%2027.5996%2017.5143C28.0983%2017.5143%2028.5059%2017.6123%2028.8224%2017.8083C29.139%2018.0043%2029.4027%2018.2237%2029.6137%2018.4663C29.8439%2018.7463%2030.0262%2019.0543%2030.1604%2019.3903C31.5224%2022.6757%2032.8172%2025.821%2034.0449%2028.8263C34.5629%2030.1143%2035.1%2031.4257%2035.6563%2032.7603C36.2126%2034.095%2036.7449%2035.3923%2037.2532%2036.6523C37.7616%2037.9123%2038.2412%2039.093%2038.6919%2040.1943C39.1427%2041.2957%2039.5312%2042.2477%2039.8573%2043.0503C40.1259%2043.685%2040.1642%2044.2543%2039.9724%2044.7583C39.7806%2045.2623%2039.3777%2045.5143%2038.7639%2045.5143ZM30.4194%2034.8743L27.6859%2025.3823H27.6571L24.607%2034.8743H30.4194Z'%20fill='white'/%3e%3c/svg%3e",R2="data:image/svg+xml,%3csvg%20width='64'%20height='64'%20viewBox='0%200%2064%2064'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M51.5064%206.75635H26.2131C21.5464%206.75635%2017.7197%2010.583%2017.7197%2015.343V34.663C17.7197%2039.423%2021.5464%2043.2497%2026.2131%2043.2497H43.3002L49.2736%2048.7564C50.9536%2050.343%2053.8469%2049.223%2053.8469%2046.8897V43.1563C58.4202%2043.1563%2059.9997%2039.3297%2059.9997%2034.663V15.343C59.9997%2010.583%2056.1731%206.75635%2051.5064%206.75635Z'%20fill='%232475FC'/%3e%3cpath%20d='M41.8745%209.22705H13.5209C8.28966%209.22705%204%2013.5167%204%2018.8526V40.5101C4%2045.7414%208.18503%2050.0311%2013.3117%2050.1357V54.3207C13.3117%2056.9364%2016.5551%2058.1919%2018.4384%2056.4133L25.1344%2050.2403H41.8745C47.1058%2050.2403%2051.3955%2045.9507%2051.3955%2040.6148V18.8526C51.3955%2013.5167%2047.1058%209.22705%2041.8745%209.22705Z'%20fill='%232CAAFF'/%3e%3cpath%20d='M40%2028.5466C40%2024.6563%2038.9206%2021.5701%2036.7617%2019.2878C34.6029%2017.0055%2031.6823%2015.8609%2028%2015.854C24.3279%2015.854%2021.4108%2016.9951%2019.2485%2019.2774C17.0863%2021.5597%2016.0034%2024.6339%2016%2028.4999C16%2032.3279%2017.0777%2035.39%2019.2331%2037.6861C21.3886%2039.9822%2024.2545%2041.132%2027.8309%2041.1354C28.8183%2041.1648%2029.8053%2041.0637%2030.7669%2040.8346C30.8591%2040.9124%2031.9402%2042.5878%2033.2724%2043.3451C34.2043%2043.8745%2035.4549%2043.9025%2036.4035%2043.8174C37.197%2043.7462%2037.6942%2042.995%2037.5728%2042.2076C37.4524%2041.4259%2036.7496%2040.8876%2035.9858%2040.6823C35.8271%2040.6396%2035.6705%2040.5883%2035.5166%2040.5286C35.0996%2040.289%2034.7638%2039.9274%2034.5534%2039.4911C38.1879%2037.2677%2040.0034%2033.6195%2040%2028.5466ZM32.4577%2035.0459L32.2118%2035.3623C32.0991%2035.5127%2031.4125%2033.9203%2029.7421%2033.4016C28.8698%2033.1793%2027.9668%2033.1241%2027.0792%2033.236C26.5605%2033.3015%2026.2067%2033.7675%2026.2067%2034.2903C26.2067%2034.8933%2026.6816%2035.3789%2027.26%2035.5489C27.6656%2035.6682%2028.0557%2035.8405%2028.4202%2036.0625C29.0914%2036.5812%2029.6806%2037.2504%2029.3937%2037.3282C28.8919%2037.4605%2028.375%2037.525%2027.8565%2037.5201C26.9593%2037.5277%2026.0755%2037.2989%2025.2921%2036.856C24.5088%2036.4131%2023.8527%2035.7714%2023.3886%2034.994C22.2716%2033.2996%2021.7114%2031.0796%2021.7079%2028.3339C21.7045%2025.5883%2022.2647%2023.3665%2023.3886%2021.6686C23.8773%2020.9032%2024.5476%2020.2739%2025.3384%2019.8381C26.1292%2019.4024%2027.0151%2019.1741%2027.9155%2019.1741C28.8158%2019.1741%2029.7018%2019.4024%2030.4925%2019.8381C31.2833%2020.2739%2031.9536%2020.9032%2032.4424%2021.6686C33.5798%2023.325%2034.1486%2025.5364%2034.1486%2028.3028C34.1486%2031.1418%2033.585%2033.3895%2032.4577%2035.0459Z'%20fill='white'/%3e%3c/svg%3e",M=n=>(P("data-v-0c724719"),n=n(),R(),n),U2={class:"add-libray-popup",ref:"modal"},H2={class:"add-libray-popup-body"},E2=M(()=>t("div",{class:"popup-title"},"新建知识库",-1)),Z2={class:"libray-type-list"},z2=M(()=>t("div",{class:"libray-item-header"},[t("img",{class:"libray-icon",src:P2,alt:""}),t("div",{class:"libray-type-name"},"普通知识库")],-1)),N2=M(()=>t("div",{class:"libray-desc"}," 导入文档或网页创建知识库，知识库可以与聊天机器人或工作流关联。用户和机器人聊天时，机器人可以引用知识库内知识回复用户 ",-1)),K2={class:"libray-action"},j2=M(()=>t("div",{class:"libray-item-header"},[t("img",{class:"libray-icon",src:R2,alt:""}),t("div",{class:"libray-type-name"},"问答知识库")],-1)),J2=M(()=>t("div",{class:"libray-desc"}," 通过excel或者word导入FAQ问答对构建知识库，适合客服场景或者需要用FAQ问答数据精确回答的场景。用户提问时，如果系统检索到与用户问题匹配度很高的问答对，会直接回复对应的答案。 ",-1)),Q2={class:"libray-action"},Y2={__name:"add-libray-popup",emits:["ok"],setup(n,{expose:k,emit:b}){const _=b,u=L(!1),v=()=>{u.value=!0},e=()=>{u.value=!1},m=l=>{u.value=!1,_("ok",l)},y=l=>{m(l)};return k({show:v,close:e}),(l,f)=>{const h=U;return C(),w("div",U2,[o(h,{footer:null,getContainer:()=>l.$refs.modal,open:u.value,"onUpdate:open":f[2]||(f[2]=g=>u.value=g),title:"",width:520,onOk:m},{default:p(()=>[t("div",H2,[E2,t("div",Z2,[t("div",{class:"libray-item",onClick:f[0]||(f[0]=g=>y(0))},[z2,N2,t("div",K2,[o($(E))])]),t("div",{class:"libray-item",onClick:f[1]||(f[1]=g=>y(2))},[j2,J2,t("div",Q2,[o($(E))])])])])]),_:1},8,["getContainer","open"])],512)}}},G2=T(Y2,[["__scopeId","data-v-0c724719"]]),X2=n=>(P("data-v-56b69311"),n=n(),R(),n),W2={class:"form-box"},e0=X2(()=>t("div",{class:"form-item-tip"},"请上传知识库封面，建议尺寸为100*100px.大小不超过100kb",-1)),t0={__name:"add-library-model",setup(n,{expose:k}){O.config({duration:2});const b=z(),_=L(!1),u=Z.useForm,v=L(!1),e=H({type:"0",access_rights:0,library_name:"",library_intro:"",use_model:"",model_config_id:"",library_files:void 0,avatar:"",avatar_file:void 0,is_offline:!1,urls:"",doc_type:1,file_name:"",is_qa_doc:0,qa_index_type:1,doc_auto_renew_frequency:1}),m=H({library_name:[{required:!0,message:"请输入库名称",trigger:"change"}]}),{validate:y,validateInfos:l}=u(e,m),f=a=>{e.avatar=a.imageUrl,e.avatar_file=a.file},h=()=>{_.value=!1},g=()=>{y().then(()=>{i()}).catch(a=>{})},i=()=>{let a=new FormData,s=JSON.parse(JSON.stringify(e));a.append("type",e.type),a.append("access_rights",e.access_rights),a.append("library_name",e.library_name),a.append("library_intro",e.library_intro),a.append("use_model",s.use_model),a.append("model_config_id",e.model_config_id),a.append("avatar",e.avatar_file?e.avatar_file:""),a.append("is_offline",e.is_offline),a.append("urls",JSON.stringify(_2(e.urls))),a.append("doc_type",e.doc_type),a.append("file_name",e.file_name),a.append("is_qa_doc",e.is_qa_doc),a.append("qa_index_type",e.qa_index_type),a.append("doc_auto_renew_frequency",e.doc_auto_renew_frequency),v.value=!0,r2(a).then(c=>{O.success("创建成功"),_.value=!1;let r="/library/details/knowledge-document",d={id:c.data.id};e.doc_type==3&&(r="/library/preview",d={id:c.data.file_ids[0]}),b.push({path:r,query:d}),v.value=!1,_.value=!1}).catch(()=>{v.value=!1})};return k({show:({type:a})=>{e.type=a,a==0?(e.avatar=V,e.avatar_file=V):(e.avatar=B,e.avatar_file=B),_.value=!0}}),Y(()=>{}),(a,s)=>{const c=m2,r=u2,d=f2,q=Z,N=U;return C(),G(N,{open:_.value,"onUpdate:open":s[3]||(s[3]=x=>_.value=x),title:"添加知识库",onOk:g,confirmLoading:v.value,onCancel:h,width:"640px"},{default:p(()=>[t("div",W2,[o(q,{"label-col":{span:5}},{default:p(()=>[o(r,D({ref:"name",label:"知识库名称"},$(l).library_name),{default:p(()=>[o(c,{value:e.library_name,"onUpdate:value":s[0]||(s[0]=x=>e.library_name=x),placeholder:"请输入知识库名称，最多20个字",maxlength:20},null,8,["value"])]),_:1},16),o(r,D({label:"知识库简介"},$(l).library_intro),{default:p(()=>[o(d,{maxlength:1e3,value:e.library_intro,"onUpdate:value":s[1]||(s[1]=x=>e.library_intro=x),placeholder:"请输入知识库介绍"},null,8,["value"])]),_:1},16),o(r,D({ref:"name",label:"知识库封面"},$(l).avatar),{default:p(()=>[o(p2,{value:e.avatar,"onUpdate:value":s[2]||(s[2]=x=>e.avatar=x),onChange:f},null,8,["value"]),e0]),_:1},16)]),_:1})])]),_:1},8,["open","confirmLoading"])}}},a0=T(t0,[["__scopeId","data-v-56b69311"]]),o0={"bg-color":"#f5f9ff",class:"library-page"},s0={class:"library-page-body"},i0={__name:"library-list",setup(n){const k=W();let{role_permission:b}=k;const _=X(()=>b.includes("LibraryCreate")),u=z(),v=L(null),e=L(null),m=()=>{e.value.show()},y=s=>{v.value.show({type:s})},l=L("all"),f=L([]),h=()=>{let s=l.value==="all"?"":l.value;d2({type:s}).then(c=>{let r=c.data||[];r.forEach(d=>{d.file_size_str=e2(d.file_size),d.avatar||(d.avatar=d.type==0?V:B)}),f.value=r})};h();const g=()=>{h()},i=s=>{s.type=="1"?u.push({path:"/public-library/config",query:{library_id:s.id}}):u.push({name:"libraryDetails",query:{id:s.id}})},A=s=>{let c=3,r=U.confirm({title:`删除${s.library_name}`,icon:o(t2),content:"您确定要删除此知识库吗？",okText:c+" 确 定",okType:"danger",okButtonProps:{disabled:!0},cancelText:"取 消",onOk(){a(s)},onCancel(){}}),d=setInterval(()=>{c==1?(r.update({okText:"确 定",okButtonProps:{disabled:!1}}),clearInterval(d),d=void 0):(c-=1,r.update({okText:c+" 确 定",okButtonProps:{disabled:!0}}))},1e3)},a=({id:s})=>{c2({id:s}).then(()=>{O.success("删除成功"),h()})};return(s,c)=>{const r=y2,d=v2;return C(),w("div",o0,[t("div",s0,[o(d,{activeKey:l.value,"onUpdate:activeKey":c[0]||(c[0]=q=>l.value=q),onChange:g},{default:p(()=>[o(r,{key:"all",tab:"全部"}),o(r,{key:"0",tab:"普通知识库","force-render":""}),o(r,{key:"2",tab:"问答知识库"})]),_:1},8,["activeKey"]),t("div",null,[o(B2,{"show-create":_.value,list:f.value,onAdd:m,onEdit:i,onDelete:A},null,8,["show-create","list"])])]),o(G2,{ref_key:"addLibrayPopup",ref:e,onOk:y},null,512),o(a0,{ref_key:"addLibraryModelRef",ref:v},null,512)])}}},X0=T(i0,[["__scopeId","data-v-7cf7eb5c"]]);export{X0 as default};
