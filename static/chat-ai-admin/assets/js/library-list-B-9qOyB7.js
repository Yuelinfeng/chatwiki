import{L as C,M as g,V as t,j as s,u as L,a8 as F,F as K,a1 as j,Y as M,a7 as I,Q as f,a3 as V,a4 as P,r as x,$ as z,A as H,v as J,P as Q,U as D,b as Y}from"./vue-chunks-CX0PHdkT.js";import{_ as S,M as R,e as O,bs as T,bt as B,d as G,bu as W,E as X}from"../../index-CstSXCdU.js";import{_ as e2,M as t2}from"./index-CPSClIuB.js";import"./index-dl1p0SLK.js";import{D as a2}from"./dropdown-ncLr3TGE.js";import{P as o2}from"./PlusCircleOutlined-yvPPtXhm.js";import{M as s2}from"./MoreOutlined-DjXfniqe.js";import{R as E}from"./RightOutlined-CGdQ7_SL.js";import{c as i2,g as l2,d as n2}from"./index-Bnyi_NyK.js";import{A as r2}from"./avatar-input-DjpBqMcc.js";import{t as d2}from"./validate-8MtiUsxW.js";import{F as Z,_ as c2}from"./index-L1GceNF2.js";import"./index-mgtqK7H6.js";import{I as p2}from"./Input-CCZkwFQT.js";import{_ as _2}from"./TextArea-tZiQ0s1q.js";import{T as m2,_ as u2}from"./index-ecTSolhs.js";import"./axios-Cm0UX6qg.js";import"./qs-D52wVmk8.js";import"./crypto-js-ZYyBUTQg.js";import"./dayjs-DItM2b4N.js";import"./shallowequal-BtoafKsn.js";import"./colors-C2VfdtVY.js";import"./ResizeObserver.es-B1PUzC5B.js";import"./collapseMotion-7Vnsd4b5.js";import"./slide-C2DT8m2K.js";import"./index-v-hTEyV7.js";import"./index-bwfsT3yL.js";import"./Dropdown-BXle2wjv.js";import"./move-7f3qAgDa.js";import"./PlusOutlined-4Hup-Qb7.js";import"./index-Ci9NPZWz.js";import"./partition-CEDJAJmg.js";import"./Password-BPL4Bd2T.js";import"./inputProps-BGPPkc5V.js";import"./CheckOutlined-VXIK4oM4.js";import"./useRefs-DaOtXq3f.js";import"./FormItemContext-BHAiblOr.js";import"./isPlainObject-DadmzF58.js";import"./responsiveObserve-S5D8rlR7.js";import"./QuestionCircleOutlined-DWuvpisG.js";import"./index-BHTxBMxE.js";import"./Search-DdoCxxLO.js";import"./SearchOutlined-CTCDQEDm.js";import"./statusUtils-DAHCu8QH.js";import"./pick-BiMyb7X9.js";import"./isMobile-D_4OiXLP.js";const f2=n=>(V("data-v-4a7b76e3"),n=n(),P(),n),v2={class:"list-box"},y2={key:0,class:"list-item-wrapper"},C2=f2(()=>t("span",{class:"add-library-text"},"新增知识库",-1)),b2=["onClick"],h2={class:"item-header"},g2=["src"],w2={class:"library-title"},k2=["onClick"],x2=["onClick"],L2={class:"item-body"},$2={class:"library-type"},A2={key:0,class:"type-tag"},F2={key:1,class:"type-tag"},M2={key:2,class:"type-tag"},I2={class:"library-desc"},S2={class:"library-size"},q2={class:"file-size"},D2={__name:"index",props:{list:{type:Array,default:()=>[]},showCreate:{type:Boolean,default:!0}},emits:["add","edit","delete"],setup(n,{emit:w}){const b=w,p=n,_=m=>{b("edit",m)},v=m=>{b("add",m)},e=m=>{b("delete",m)};return(m,y)=>{const l=e2,u=t2,h=a2;return C(),g("div",v2,[p.showCreate?(C(),g("div",y2,[t("div",{class:"list-item add-library",onClick:v},[s(L(o2),{class:"add-library-icon"}),C2])])):F("",!0),(C(!0),g(K,null,j(p.list,i=>(C(),g("div",{class:"list-item-wrapper",key:i.id},[t("div",{class:"list-item",onClick:I($=>_(i),["stop"])},[t("div",h2,[t("img",{class:"library-icon",src:i.avatar,alt:""},null,8,g2),t("div",w2,M(i.library_name),1),t("span",{class:"item-action",onClick:y[1]||(y[1]=I(()=>{},["stop"]))},[s(h,null,{overlay:f(()=>[s(u,null,{default:f(()=>[s(l,null,{default:f(()=>[t("a",{href:"javascript:;",onClick:I($=>_(i),["stop"])},"管 理",8,k2)]),_:2},1024),s(l,null,{default:f(()=>[t("a",{class:"delete-text-color",href:"javascript:;",onClick:$=>e(i)},"删 除",8,x2)]),_:2},1024)]),_:2},1024)]),default:f(()=>[t("span",{class:"menu-btn",onClick:y[0]||(y[0]=I(()=>{},["prevent"]))},[s(L(s2))])]),_:2},1024)])]),t("div",L2,[t("div",$2,[i.type==0?(C(),g("span",A2,"普通知识库")):F("",!0),i.type==1?(C(),g("span",F2,"对外知识库")):F("",!0),i.type==2?(C(),g("span",M2,"问答知识库")):F("",!0)]),t("div",I2,M(i.library_intro),1)]),t("div",S2,[t("span",null,"文档数："+M(i.file_total),1),t("span",q2,"文档大小："+M(i.file_size_str),1)])],8,b2)]))),128))])}}},O2=S(D2,[["__scopeId","data-v-4a7b76e3"]]),T2="data:image/svg+xml,%3csvg%20width='64'%20height='64'%20viewBox='0%200%2064%2064'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M29.8066%2055.3034C14.0866%2051.3489%2011.0624%2045.5975%2015.5685%2027.6849C20.074%209.77234%2025.4347%206.23271%2041.1546%2010.1872C56.8746%2014.1417%2059.8378%2019.7747%2055.3323%2037.6873C50.8267%2055.5999%2045.5265%2059.2579%2029.8059%2055.3034H29.8066Z'%20fill='%232475FC'/%3e%3cpath%20d='M27.6401%2056.8699C9.97054%2056.8699%205.24487%2051.5938%205.24487%2031.46C5.24487%2011.3261%209.97054%206.15887%2027.6401%206.15887C45.3096%206.15887%2049.9398%2011.3261%2049.9398%2031.46C49.9398%2051.5938%2045.3096%2056.8699%2027.6401%2056.8699Z'%20fill='%232CAAFF'/%3e%3cpath%20d='M38.7639%2045.5143H36.8936C36.3373%2045.5143%2035.8577%2045.4677%2035.4549%2045.3743C35.052%2045.281%2034.7067%2045.1363%2034.419%2044.9403C34.1313%2044.7443%2033.8867%2044.497%2033.6853%2044.1983C33.4838%2043.8997%2033.2968%2043.5543%2033.1242%2043.1623C32.8364%2042.453%2032.5727%2041.809%2032.3329%2041.2303C32.0931%2040.6517%2031.8869%2040.1477%2031.7142%2039.7183C31.5032%2039.233%2031.3114%2038.785%2031.1388%2038.3743H23.974C23.8397%2038.8037%2023.6767%2039.2703%2023.4849%2039.7743C23.3314%2040.2037%2023.13%2040.7217%2022.8806%2041.3283C22.6312%2041.935%2022.3435%2042.593%2022.0174%2043.3023C21.6337%2044.1423%2021.1925%2044.721%2020.6938%2045.0383C20.195%2045.3557%2019.6291%2045.5143%2018.9961%2045.5143H17.0107C16.1667%2045.5143%2015.596%2045.3323%2015.2986%2044.9683C15.0013%2044.6043%2015.0253%2043.9837%2015.3706%2043.1063C15.7159%2042.2663%2016.1187%2041.277%2016.5791%2040.1383C17.0395%2038.9997%2017.5286%2037.791%2018.0466%2036.5123C18.5645%2035.2337%2019.1016%2033.9223%2019.6579%2032.5783C20.2142%2031.2343%2020.7513%2029.9183%2021.2693%2028.6303C22.497%2025.625%2023.7822%2022.4983%2025.125%2019.2503C25.2593%2018.933%2025.4319%2018.6437%2025.6429%2018.3823C25.8347%2018.177%2026.0889%2017.981%2026.4054%2017.7943C26.7219%2017.6077%2027.12%2017.5143%2027.5996%2017.5143C28.0983%2017.5143%2028.5059%2017.6123%2028.8224%2017.8083C29.139%2018.0043%2029.4027%2018.2237%2029.6137%2018.4663C29.8439%2018.7463%2030.0262%2019.0543%2030.1604%2019.3903C31.5224%2022.6757%2032.8172%2025.821%2034.0449%2028.8263C34.5629%2030.1143%2035.1%2031.4257%2035.6563%2032.7603C36.2126%2034.095%2036.7449%2035.3923%2037.2532%2036.6523C37.7616%2037.9123%2038.2412%2039.093%2038.6919%2040.1943C39.1427%2041.2957%2039.5312%2042.2477%2039.8573%2043.0503C40.1259%2043.685%2040.1642%2044.2543%2039.9724%2044.7583C39.7806%2045.2623%2039.3777%2045.5143%2038.7639%2045.5143ZM30.4194%2034.8743L27.6859%2025.3823H27.6571L24.607%2034.8743H30.4194Z'%20fill='white'/%3e%3c/svg%3e",B2="data:image/svg+xml,%3csvg%20width='64'%20height='64'%20viewBox='0%200%2064%2064'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M51.5064%206.75635H26.2131C21.5464%206.75635%2017.7197%2010.583%2017.7197%2015.343V34.663C17.7197%2039.423%2021.5464%2043.2497%2026.2131%2043.2497H43.3002L49.2736%2048.7564C50.9536%2050.343%2053.8469%2049.223%2053.8469%2046.8897V43.1563C58.4202%2043.1563%2059.9997%2039.3297%2059.9997%2034.663V15.343C59.9997%2010.583%2056.1731%206.75635%2051.5064%206.75635Z'%20fill='%232475FC'/%3e%3cpath%20d='M41.8745%209.22705H13.5209C8.28966%209.22705%204%2013.5167%204%2018.8526V40.5101C4%2045.7414%208.18503%2050.0311%2013.3117%2050.1357V54.3207C13.3117%2056.9364%2016.5551%2058.1919%2018.4384%2056.4133L25.1344%2050.2403H41.8745C47.1058%2050.2403%2051.3955%2045.9507%2051.3955%2040.6148V18.8526C51.3955%2013.5167%2047.1058%209.22705%2041.8745%209.22705Z'%20fill='%232CAAFF'/%3e%3cpath%20d='M40%2028.5466C40%2024.6563%2038.9206%2021.5701%2036.7617%2019.2878C34.6029%2017.0055%2031.6823%2015.8609%2028%2015.854C24.3279%2015.854%2021.4108%2016.9951%2019.2485%2019.2774C17.0863%2021.5597%2016.0034%2024.6339%2016%2028.4999C16%2032.3279%2017.0777%2035.39%2019.2331%2037.6861C21.3886%2039.9822%2024.2545%2041.132%2027.8309%2041.1354C28.8183%2041.1648%2029.8053%2041.0637%2030.7669%2040.8346C30.8591%2040.9124%2031.9402%2042.5878%2033.2724%2043.3451C34.2043%2043.8745%2035.4549%2043.9025%2036.4035%2043.8174C37.197%2043.7462%2037.6942%2042.995%2037.5728%2042.2076C37.4524%2041.4259%2036.7496%2040.8876%2035.9858%2040.6823C35.8271%2040.6396%2035.6705%2040.5883%2035.5166%2040.5286C35.0996%2040.289%2034.7638%2039.9274%2034.5534%2039.4911C38.1879%2037.2677%2040.0034%2033.6195%2040%2028.5466ZM32.4577%2035.0459L32.2118%2035.3623C32.0991%2035.5127%2031.4125%2033.9203%2029.7421%2033.4016C28.8698%2033.1793%2027.9668%2033.1241%2027.0792%2033.236C26.5605%2033.3015%2026.2067%2033.7675%2026.2067%2034.2903C26.2067%2034.8933%2026.6816%2035.3789%2027.26%2035.5489C27.6656%2035.6682%2028.0557%2035.8405%2028.4202%2036.0625C29.0914%2036.5812%2029.6806%2037.2504%2029.3937%2037.3282C28.8919%2037.4605%2028.375%2037.525%2027.8565%2037.5201C26.9593%2037.5277%2026.0755%2037.2989%2025.2921%2036.856C24.5088%2036.4131%2023.8527%2035.7714%2023.3886%2034.994C22.2716%2033.2996%2021.7114%2031.0796%2021.7079%2028.3339C21.7045%2025.5883%2022.2647%2023.3665%2023.3886%2021.6686C23.8773%2020.9032%2024.5476%2020.2739%2025.3384%2019.8381C26.1292%2019.4024%2027.0151%2019.1741%2027.9155%2019.1741C28.8158%2019.1741%2029.7018%2019.4024%2030.4925%2019.8381C31.2833%2020.2739%2031.9536%2020.9032%2032.4424%2021.6686C33.5798%2023.325%2034.1486%2025.5364%2034.1486%2028.3028C34.1486%2031.1418%2033.585%2033.3895%2032.4577%2035.0459Z'%20fill='white'/%3e%3c/svg%3e",A=n=>(V("data-v-107545a2"),n=n(),P(),n),V2={class:"add-libray-popup",ref:"modal"},P2={class:"add-libray-popup-body"},R2=A(()=>t("div",{class:"popup-title"},"新建知识库",-1)),U2={class:"libray-type-list"},H2=A(()=>t("div",{class:"libray-item-header"},[t("img",{class:"libray-icon",src:T2,alt:""}),t("div",{class:"libray-type-name"},"普通知识库")],-1)),E2=A(()=>t("div",{class:"libray-desc"}," 导入文档或网页创建知识库，知识库可以与聊天机器人或工作流关联。用户和机器人聊天时，机器人可以引用知识库内知识回复用户 ",-1)),Z2={class:"libray-action"},z2=A(()=>t("div",{class:"libray-item-header"},[t("img",{class:"libray-icon",src:B2,alt:""}),t("div",{class:"libray-type-name"},"问答知识库")],-1)),N2=A(()=>t("div",{class:"libray-desc"}," 通过excel或者word导入FAQ问答对构建知识库，适合客服场景或者需要用FAQ问答数据精确回答的场景。用户提问时，如果系统检索到与用户问题匹配度很高的问答对，会直接回复对应的答案。 ",-1)),K2={class:"libray-action"},j2={__name:"add-libray-popup",emits:["ok"],setup(n,{expose:w,emit:b}){const p=b,_=x(!1),v=()=>{_.value=!0},e=()=>{_.value=!1},m=l=>{_.value=!1,p("ok",l)},y=l=>{m(l)};return w({show:v,close:e}),(l,u)=>{const h=R;return C(),g("div",V2,[s(h,{footer:null,getContainer:()=>l.$refs.modal,open:_.value,"onUpdate:open":u[2]||(u[2]=i=>_.value=i),title:"",width:520,onOk:m},{default:f(()=>[t("div",P2,[R2,t("div",U2,[t("div",{class:"libray-item",onClick:u[0]||(u[0]=i=>y(0))},[H2,E2,t("div",Z2,[s(L(E))])]),t("div",{class:"libray-item",onClick:u[1]||(u[1]=i=>y(2))},[z2,N2,t("div",K2,[s(L(E))])])])])]),_:1},8,["getContainer","open"])],512)}}},J2=S(j2,[["__scopeId","data-v-107545a2"]]),Q2=n=>(V("data-v-de5e2861"),n=n(),P(),n),Y2={class:"form-box"},G2=Q2(()=>t("div",{class:"form-item-tip"},"请上传知识库封面，建议尺寸为100*100px.大小不超过100kb",-1)),W2={__name:"add-library-model",setup(n,{expose:w}){O.config({duration:2});const b=z(),p=x(!1),_=Z.useForm,v=x(!1),e=H({type:"0",access_rights:0,library_name:"",library_intro:"",use_model:"",model_config_id:"",library_files:void 0,avatar:"",avatar_file:void 0,is_offline:!1,urls:"",doc_type:1,file_name:"",is_qa_doc:0,qa_index_type:1,doc_auto_renew_frequency:1}),m=H({library_name:[{required:!0,message:"请输入库名称",trigger:"change"}]}),{validate:y,validateInfos:l}=_(e,m),u=a=>{e.avatar=a.imageUrl,e.avatar_file=a.file},h=()=>{p.value=!1},i=()=>{y().then(()=>{$()}).catch(a=>{})},$=()=>{let a=new FormData,o=JSON.parse(JSON.stringify(e));a.append("type",e.type),a.append("access_rights",e.access_rights),a.append("library_name",e.library_name),a.append("library_intro",e.library_intro),a.append("use_model",o.use_model),a.append("model_config_id",e.model_config_id),a.append("avatar",e.avatar_file?e.avatar_file:""),a.append("is_offline",e.is_offline),a.append("urls",JSON.stringify(d2(e.urls))),a.append("doc_type",e.doc_type),a.append("file_name",e.file_name),a.append("is_qa_doc",e.is_qa_doc),a.append("qa_index_type",e.qa_index_type),a.append("doc_auto_renew_frequency",e.doc_auto_renew_frequency),v.value=!0,i2(a).then(c=>{O.success("创建成功"),p.value=!1;let r="/library/details/knowledge-document",d={id:c.data.id};e.doc_type==3&&(r="/library/preview",d={id:c.data.file_ids[0]}),b.push({path:r,query:d}),v.value=!1,p.value=!1}).catch(()=>{v.value=!1})};return w({show:({type:a})=>{e.type=a,a==0?(e.avatar=T,e.avatar_file=T):(e.avatar=B,e.avatar_file=B),p.value=!0}}),J(()=>{}),(a,o)=>{const c=p2,r=c2,d=_2,q=Z,N=R;return C(),Q(N,{open:p.value,"onUpdate:open":o[3]||(o[3]=k=>p.value=k),title:"添加知识库",onOk:i,confirmLoading:v.value,onCancel:h,width:"640px"},{default:f(()=>[t("div",Y2,[s(q,{"label-col":{span:5}},{default:f(()=>[s(r,D({ref:"name",label:"知识库名称"},L(l).library_name),{default:f(()=>[s(c,{value:e.library_name,"onUpdate:value":o[0]||(o[0]=k=>e.library_name=k),placeholder:"请输入知识库名称，最多20个字",maxlength:20},null,8,["value"])]),_:1},16),s(r,D({label:"知识库简介"},L(l).library_intro),{default:f(()=>[s(d,{maxlength:1e3,value:e.library_intro,"onUpdate:value":o[1]||(o[1]=k=>e.library_intro=k),placeholder:"请输入知识库介绍"},null,8,["value"])]),_:1},16),s(r,D({ref:"name",label:"知识库封面"},L(l).avatar),{default:f(()=>[s(r2,{value:e.avatar,"onUpdate:value":o[2]||(o[2]=k=>e.avatar=k),onChange:u},null,8,["value"]),G2]),_:1},16)]),_:1})])]),_:1},8,["open","confirmLoading"])}}},X2=S(W2,[["__scopeId","data-v-de5e2861"]]),e0={"bg-color":"#f5f9ff",class:"library-page"},t0={class:"library-page-body"},a0={__name:"library-list",setup(n){const w=G();let{role_permission:b}=w;const p=Y(()=>b.includes("LibraryCreate")),_=z(),v=x(null),e=x(null),m=()=>{e.value.show()},y=o=>{v.value.show({type:o})},l=x("all"),u=x([]),h=()=>{let o=l.value==="all"?"":l.value;l2({type:o}).then(c=>{let r=c.data||[];r.forEach(d=>{d.file_size_str=W(d.file_size),d.avatar||(d.avatar=d.type==0?T:B)}),u.value=r})};h();const i=()=>{h()},$=o=>{o.type=="1"?_.push({path:"/public-library/config",query:{library_id:o.id}}):_.push({name:"libraryDetails",query:{id:o.id}})},U=o=>{let c=3,r=R.confirm({title:`删除${o.library_name}`,icon:s(X),content:"您确定要删除此知识库吗？",okText:c+" 确 定",okType:"danger",okButtonProps:{disabled:!0},cancelText:"取 消",onOk(){a(o)},onCancel(){}}),d=setInterval(()=>{c==1?(r.update({okText:"确 定",okButtonProps:{disabled:!1}}),clearInterval(d),d=void 0):(c-=1,r.update({okText:c+" 确 定",okButtonProps:{disabled:!0}}))},1e3)},a=({id:o})=>{n2({id:o}).then(()=>{O.success("删除成功"),h()})};return(o,c)=>{const r=u2,d=m2;return C(),g("div",e0,[t("div",t0,[s(d,{activeKey:l.value,"onUpdate:activeKey":c[0]||(c[0]=q=>l.value=q),onChange:i},{default:f(()=>[s(r,{key:"all",tab:"全部"}),s(r,{key:"0",tab:"普通知识库","force-render":""}),s(r,{key:"2",tab:"问答知识库"})]),_:1},8,["activeKey"]),t("div",null,[s(O2,{"show-create":p.value,list:u.value,onAdd:m,onEdit:$,onDelete:U},null,8,["show-create","list"])])]),s(J2,{ref_key:"addLibrayPopup",ref:e,onOk:y},null,512),s(X2,{ref_key:"addLibraryModelRef",ref:v},null,512)])}}},Q0=S(a0,[["__scopeId","data-v-46874fe7"]]);export{Q0 as default};
