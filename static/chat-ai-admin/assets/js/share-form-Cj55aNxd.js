import{b as W,cK as q,k as c,B as A,d as E,J}from"../../index-DrRzkLrM.js";import{u as Q}from"./index-GyXENfWt.js";import{k as X,h as Y}from"./index-DJ_e7lS-.js";import{a4 as G,b as I,r as f,A as H,L as n,M as u,V as p,j as s,Q as o,u as y,X as _,P as b,F as Z,_ as ee,Y as te,a6 as d,a9 as ae,a0 as oe,a1 as re}from"./vue-chunks-Be7x44a8.js";import"./index-DLT3QCQZ.js";import{R as se,_ as le}from"./RadioButton-_CwniGKN.js";import{_ as ne}from"./index-CA_jlLpR.js";import{I as ie}from"./Input-BoEXW7Ed.js";import{_ as ce,F as ue}from"./index-DiumbRRT.js";import{S as _e,_ as de}from"./index-olzhrUzL.js";const pe=r=>(oe("data-v-60b773ef"),r=r(),re(),r),me={class:"share-form-body"},fe={class:"share-url-box",style:{width:"100",overflow:"hidden"}},ye={key:0,target:"_blank",href:"/#/user/domain"},be={key:0,class:"form-box-bottom"},ve=pe(()=>p("span",null,"复制链接",-1)),he={__name:"share-form",props:{baseUrl:{type:String,default:"/open/doc"},hideCopy:{type:Boolean,default:!1},layout:{type:String,default:"horizontal"},labelCol:{type:Object,default:()=>{}},wrapperCol:{type:Object,default:()=>{}},libraryId:{type:[Number,String],default:""},libraryKey:{type:String,default:""}},emits:["success"],setup(r,{expose:L,emit:B}){const R=B,{operate_rights:m}=q(),F=r,{toClipboard:N}=Q(),U=G(),V=I(()=>U.query.library_id),v=f(""),h=f(null),t=H({type:1,library_intro:"",library_name:"",model_config_id:"",model_define:"",use_model:"",is_offline:!1,access_rights:"0",share_url:"",library_key:"",avatar:"",avatar_file:""}),g=I(()=>F.baseUrl+"/"+v.value),j=async()=>{try{const e=await Y({id:V.value});Object.assign(t,e.data)}catch(e){c.error("获取数据失败"),console.error("获取知识库信息失败:",e)}},i=f([]),D=()=>{J().then(e=>{i.value=e.data||[],t.share_url||(i.value.length>0?t.share_url=i.value[0].url:t.share_url=window.location.origin)})},k=async()=>{t.share_url||c.error("请选择自定义域名");let e=t.share_url+g.value;try{await N(e),c.success("复制成功")}catch{c.error("复制失败")}},w=async()=>{let e={...ae(t)};delete e.library_key,e.avatar_file?(e.avatar=e.avatar_file,delete e.avatar_file):(delete e.avatar,delete e.avatar_file);try{let a=await X(e);R("success",a)}catch{}};return L({init:async e=>{try{v.value=e.doc_key,await j(),D()}catch{}}}),(e,a)=>{const C=se,O=le,S=ce,P=_e,$=de,z=ie,K=ne,x=A,M=ue,T=E;return n(),u("div",{class:"share-form",ref_key:"formWrapRef",ref:h},[p("div",me,[s(M,{model:t,layout:r.layout,"label-col":r.labelCol,"wrapper-col":r.wrapperCol,autocomplete:"off"},{default:o(()=>[s(S,{label:"访问权限"},{default:o(()=>[s(O,{value:t.access_rights,"onUpdate:value":a[0]||(a[0]=l=>t.access_rights=l),onChange:w,disabled:y(m)==2},{default:o(()=>[s(C,{value:"0"},{default:o(()=>[_("私有，仅能与应用关联，作为应用知识库")]),_:1}),s(C,{value:"1"},{default:o(()=>[_("公开，发布到互联网，所有人可访问")]),_:1})]),_:1},8,["value","disabled"])]),_:1}),t.access_rights==1?(n(),b(S,{key:0,label:"分享链接"},{default:o(()=>[p("div",fe,[s(K,{compact:""},{default:o(()=>[s($,{style:{width:"50%"},value:t.share_url,"onUpdate:value":a[1]||(a[1]=l=>t.share_url=l),placeholder:"请选择自定义域名",getPopupContainer:()=>h.value,onChange:w,disabled:y(m)==2},{default:o(()=>[(n(!0),u(Z,null,ee(i.value,l=>(n(),b(P,{value:l.url,key:l.id},{default:o(()=>[_(te(l.url),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value","getPopupContainer","disabled"]),s(z,{disabled:!0,value:g.value,style:{width:"50%"}},null,8,["value"])]),_:1}),r.hideCopy?d("",!0):(n(),b(x,{key:0,class:"copy-btn",onClick:a[2]||(a[2]=l=>k())},{default:o(()=>[_("复制")]),_:1}))]),p("div",null,[y(m)==4?(n(),u("a",ye,"添加自定义域名")):d("",!0)])]),_:1})):d("",!0)]),_:1},8,["model","layout","label-col","wrapper-col"])]),r.hideCopy?(n(),u("div",be,[s(x,{type:"primary",ghost:"",onClick:a[3]||(a[3]=l=>k())},{default:o(()=>[s(T,{name:"link-left",style:{"font-size":"16px",color:"#2475fc","margin-right":"4px"}}),ve]),_:1})])):d("",!0)],512)}}},Ne=W(he,[["__scopeId","data-v-60b773ef"]]);export{Ne as S};
