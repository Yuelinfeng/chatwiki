import{_ as w,Y as A,Z as C}from"../../index-CWYf_R7c.js";import{c as G}from"./index-DFKCqvOx.js";import{r as S,w as L,v as X,L as s,P as y,Q as _,M,F as T,a1 as E,j as $,V as I,Y as O,X as q}from"./vue-chunks-Bxyh5WP6.js";import{_ as F}from"./index-DxeJG8dU.js";import{S as J,a as Y,_ as z}from"./index-BLHGs8uC.js";const K=["src"],P={__name:"model-select",props:{modelType:{type:String,validator:c=>["TEXT EMBEDDING","RERAN","LLM"].includes(c),required:!0},isOffline:{type:Boolean,default:!1},modeName:{type:[String,Number],default:""},modeId:{type:[String,Number],default:""},placeholder:{type:String,default:"请选择嵌入模型"}},emits:["change","update:modeName","update:modeId","loaded"],setup(c,{emit:x}){function B(n,o,t){const l=new Set(n.map(a=>a.model_define));return o.filter(a=>{let m=a[t];l.has(m)&&n.filter(e=>{if(e.model_define==m)return e.children=C(e.children,a.children),!1})}),n}const f=x,d=c,p=S();L([()=>d.modeId,()=>d.modeName],([n,o])=>{!n||!o||(p.value=n+"-"+o)});const h=S([]),D=["azure","ollama","xinference","openaiAgent"],R=(n,o)=>{f("update:modeName",o.modelName),f("update:modeId",o.modelId),f("change",n,o)},v=()=>{G({model_type:d.modelType,is_offline:d.isOffline}).then(n=>{let t=(n.data||[]).map(l=>{let{model_define:a,deployment_name:m,id:e}=l.model_config,i=`${a}-${m||""}-${e}`,r=[],N=[];d.modelType=="TEXT EMBEDDING"?r=l.model_info.vector_model_list:d.modelType=="RERANK"?r=l.model_info.rerank_model_list:d.modelType=="LLM"&&(r=l.model_info.llm_model_list);for(let g=0;g<r.length;g++){let u=r[g],k=u,V=e+"-"+u;D.indexOf(l.model_config.model_define)>-1&&l.model_config.deployment_name&&(k=l.model_config.deployment_name),N.push({key:e+"_"+u,label:k,name:u,deployment_name:m,model_config_id:e,model_define:a,value:V})}return{key:i,model_define:a,children:N,model_config_id:e,deployment_name:m,name:l.model_info.model_name,icon:l.model_info.model_icon_url}});t=B(A(t,"model_define"),t,"model_define"),t.length===0&&(p.value="无可用模型"),h.value=[...t],f("loaded",JSON.parse(JSON.stringify(t)))})};return L(()=>d.isOffline,()=>{v()}),X(()=>{v()}),(n,o)=>{const t=F,l=J,a=Y,m=z;return s(),y(m,{value:p.value,"onUpdate:value":o[0]||(o[0]=e=>p.value=e),placeholder:c.placeholder,onChange:R,style:{width:"100%"}},{default:_(()=>[(s(!0),M(T,null,E(h.value,e=>(s(),y(a,{key:e.key},{label:_(()=>[$(t,{align:"center",gap:6},{default:_(()=>[I("img",{class:"model-icon",src:e.icon,alt:""},null,8,K),I("span",null,O(e.name),1)]),_:2},1024)]),default:_(()=>[(s(!0),M(T,null,E(e.children,i=>(s(),y(l,{value:i.value,modelId:i.model_config_id,modelName:i.name,key:i.key},{default:_(()=>[q(O(i.label),1)]),_:2},1032,["value","modelId","modelName"]))),128))]),_:2},1024))),128))]),_:1},8,["value","placeholder"])}}},W=w(P,[["__scopeId","data-v-a9ad07a3"]]);export{W as M};
