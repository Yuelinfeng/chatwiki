import{k as T,h as D}from"./index-CPg8-A7z.js";import{r as g,A as y,w as E,v as A,L as k,M as F,V as s,j as t,Q as l,U as I,u as L,a7 as P,X as z,a3 as Q,a4 as X,a9 as S,a0 as Y,b as G}from"./vue-chunks-C0QQWOCx.js";import{C as H}from"./config-page-menu-vINxaTw4.js";import{_ as B,e as U,bv as J,c as K,B as W}from"../../index-0jhxEUZS.js";import{A as Z}from"./avatar-input-Ca8Zj0Dh.js";import{F as w,_ as aa}from"./index-CRVpDJ1f.js";import"./index-DLXS2gFD.js";import{I as ea}from"./Input-C2joc_0K.js";import{_ as ta}from"./TextArea-4ibeqG6S.js";import"./index-E5vI2LlI.js";import"./shallowequal-Fk1l6xhN.js";import"./colors-mU-75_cq.js";import"./ResizeObserver.es-B1PUzC5B.js";import"./collapseMotion-BOXZQl9Y.js";import"./slide-Dj1hvy3q.js";import"./index-Di6HYDsH.js";import"./index-DMH-zawU.js";import"./axios-Cm0UX6qg.js";import"./qs-CnxcMLjH.js";import"./crypto-js-C2SrYqGA.js";import"./dayjs-CsGPDCY7.js";import"./PlusOutlined-CgwfTcid.js";import"./index-CzVWingc.js";import"./partition-Cp0_1Ufx.js";import"./Password-D0V1lqaH.js";import"./inputProps-DKMe6fry.js";import"./CheckOutlined-DjzOOMrf.js";import"./useRefs-DDwzsqEq.js";import"./FormItemContext-BtHm9ijx.js";import"./isPlainObject-DgCxKo0N.js";import"./responsiveObserve-Cvd8WiWW.js";import"./QuestionCircleOutlined-BDfA4Qtk.js";import"./index-CIBVllRY.js";import"./Search-IP_DCQEs.js";import"./SearchOutlined-BPrf0z-8.js";import"./statusUtils-BN1jNO5O.js";const h=o=>(Q("data-v-d2f1a88b"),o=o(),X(),o),oa={class:"form-box"},ra={class:"form-box-header"},sa={class:"form-box-label"},ia=h(()=>s("span",{class:"form-box-label-text"},"知识库信息",-1)),na=h(()=>s("div",null,null,-1)),la=h(()=>s("div",{class:"form-item-tip"},"请上传知识库封面，建议尺寸为100*100px.大小不超过100kb",-1)),_a={__name:"library-form",props:{value:{type:Object,default:()=>({})},saveLoading:{type:Boolean,default:!1}},emits:["submit","update:value"],setup(o,{emit:d}){U.config({duration:2});const u=d,r=o,i=g(1),f=w.useForm,v=g(!1),m=J,a=y({type:i.value,access_rights:0,library_name:"",library_intro:"",use_model:"",avatar:m,avatar_file:"",is_offline:!1,model_config_id:""}),p=y({library_name:[{required:!0,message:"请输入库名称",trigger:"change"}],library_intro:[{required:!0,message:"请输入库简介",trigger:"change"}]}),b=e=>{a.avatar=e.imageUrl,a.avatar_file=e.file},{validate:C,validateInfos:x}=f(a,p),R=()=>{C().then(()=>{V()}).catch(e=>{})},V=()=>{let e=S(a);u("submit",e)},$=e=>{v.value=+e.type,a.library_name=e.library_name,a.library_intro=e.library_intro,a.use_model=e.use_model,a.model_config_id=e.model_config_id,a.avatar=e.avatar?e.avatar:m,a.avatar_file=e.avatar_file?e.avatar_file:"",a.is_offline=e.is_offline};return E(r.value,e=>{$({...e})}),A(()=>{}),(e,n)=>{const j=K,M=ea,c=aa,q=ta,N=W,O=w;return k(),F("div",oa,[s("div",ra,[s("div",sa,[t(j,{class:"form-box-label-icon",name:"book",style:{"font-size":"16px",color:"#333"}}),ia]),na]),t(O,{"label-col":{span:6},style:{width:"600px"}},{default:l(()=>[t(c,I({ref:"name",label:"知识库名称"},L(x).library_name),{default:l(()=>[t(M,{value:a.library_name,"onUpdate:value":n[0]||(n[0]=_=>a.library_name=_),placeholder:"请输入知识库名称，最多20个字","show-count":"",maxlength:20},null,8,["value"])]),_:1},16),t(c,{label:"知识库简介"},{default:l(()=>[t(q,{value:a.library_intro,"onUpdate:value":n[1]||(n[1]=_=>a.library_intro=_),placeholder:"请输入知识库介绍"},null,8,["value"])]),_:1}),t(c,I({ref:"name",label:"知识库封面"},L(x).avatar),{default:l(()=>[t(Z,{value:a.avatar,"onUpdate:value":n[2]||(n[2]=_=>a.avatar=_),onChange:b},null,8,["value"]),la]),_:1},16),t(c,{"wrapper-col":{offset:6,span:8}},{default:l(()=>[t(N,{type:"primary",style:{"margin-left":"8px"},loading:o.saveLoading,onClick:P(R,["prevent"])},{default:l(()=>[z("保存")]),_:1},8,["loading"])]),_:1})]),_:1})])}}},ma=B(_a,[["__scopeId","data-v-d2f1a88b"]]),pa={class:"add-library-page"},ca={class:"page-container"},da={class:"form-box-wrapper"},ua={__name:"index",setup(o){const d=Y(),u=G(()=>d.query.library_id),r=y({type:1,library_intro:"",library_name:"",model_config_id:"",model_define:"",use_model:"",is_offline:!1,access_rights:"0",share_url:"",library_key:"",avatar:"",avatar_file:""}),i=g(!1),f=a=>{Object.assign(r,a),i.value=!0,v().then(()=>{i.value=!1}).catch(()=>{i.value=!1})},v=async()=>{let a={...S(r)};delete a.library_key,a.avatar_file?(a.avatar=a.avatar_file,delete a.avatar_file):(delete a.avatar,delete a.avatar_file),await T(a),U.success("修改成功")},m=()=>{D({id:u.value}).then(a=>{Object.assign(r,a.data)})};return A(()=>{m()}),(a,p)=>(k(),F("div",pa,[t(H),s("div",ca,[s("div",da,[t(ma,{value:r,"onUpdate:value":p[0]||(p[0]=b=>r=b),saveLoading:i.value,onSubmit:f},null,8,["value","saveLoading"])])])]))}},Ka=B(ua,[["__scopeId","data-v-0277dff4"]]);export{Ka as default};
