import{$ as R,b as N,r as V,A as u,v as C,L as D,M as T,V as h,j as r,Q as o,U as f,u as v,X as y,a7 as E,a3 as J,a4 as M}from"./vue-chunks-CX0PHdkT.js";import{c as O,h as Y}from"./index-VltaZJWM.js";import{A as $}from"./avatar-input-B8y8pxUf.js";import{_ as j,e as b,bs as H,bv as P,B as Q}from"../../index-GVMBwoSB.js";import{t as X}from"./validate-8MtiUsxW.js";import{F as g,_ as z}from"./index-BL197tQK.js";import"./index-CKa5RZod.js";import{I as G}from"./Input--aGP1T3B.js";import{_ as K}from"./TextArea-DeS198JN.js";import"./PlusOutlined-sorM8mvn.js";import"./index-DTami1oY.js";import"./partition-B-kgZtUf.js";import"./colors-D_W7fn18.js";import"./ResizeObserver.es-B1PUzC5B.js";import"./Password-DduaVHe6.js";import"./inputProps-BUZdA0Zp.js";import"./index-3QeQOpaK.js";import"./CheckOutlined-DWxGZyjB.js";import"./useRefs-DaOtXq3f.js";import"./collapseMotion-7Vnsd4b5.js";import"./FormItemContext-2KmsKwBN.js";import"./axios-Cm0UX6qg.js";import"./qs-D52wVmk8.js";import"./crypto-js-ZYyBUTQg.js";import"./dayjs-DItM2b4N.js";import"./isPlainObject-BNcE28c5.js";import"./responsiveObserve-CXBgjl43.js";import"./QuestionCircleOutlined-BtZ-HKyh.js";import"./index-DaXP6XK8.js";import"./Search-DaeGz4LJ.js";import"./SearchOutlined-DS22VXIZ.js";import"./statusUtils-BFiV3r53.js";import"./index-CZ0E7pKU.js";const W=s=>(J("data-v-7ad9a1bd"),s=s(),M(),s),Z={class:"add-library-page"},aa={class:"form-box"},ea=W(()=>h("div",{class:"form-item-tip"},"请上传知识库封面，建议尺寸为100*100px.大小不超过100kb",-1)),ta={__name:"index",setup(s){b.config({duration:2});const m=R(),l=N(()=>1),x=g.useForm,n=V(!1),A=l.value==0?H:P,a=u({type:l.value,access_rights:0,library_name:"",library_intro:"",use_model:"",model_config_id:"",library_files:void 0,avatar:A,avatar_file:void 0,is_offline:!1,urls:"",doc_type:1,file_name:"",is_qa_doc:l.value==2?1:0,qa_index_type:1,doc_auto_renew_frequency:1}),q=u({library_name:[{required:!0,message:"请输入库名称",trigger:"change"}]}),{validate:I,validateInfos:d}=x(a,q),F=e=>{a.avatar=e.imageUrl,a.avatar_file=e.file},w=()=>{m.back()},S=()=>{I().then(()=>{k()}).catch(e=>{})},k=()=>{let e=new FormData,t=JSON.parse(JSON.stringify(a));e.append("type",a.type),e.append("access_rights",a.access_rights),e.append("library_name",a.library_name),e.append("library_intro",a.library_intro),e.append("use_model",t.use_model),e.append("model_config_id",a.model_config_id),e.append("avatar",a.avatar_file?a.avatar_file:""),e.append("is_offline",a.is_offline),e.append("urls",JSON.stringify(X(a.urls))),e.append("doc_type",a.doc_type),e.append("file_name",a.file_name),e.append("is_qa_doc",a.is_qa_doc),e.append("qa_index_type",a.qa_index_type),e.append("doc_auto_renew_frequency",a.doc_auto_renew_frequency),n.value=!0,O(e).then(_=>{b.success("创建成功"),L(_.data.id)}).catch(()=>{n.value=!1})},L=e=>{Y({id:e}).then(t=>{n.value=!1,m.replace({path:"/public-library/config",query:{library_id:t.data.id,library_key:t.data.library_key}})}).catch(()=>{n.value=!1})};return C(()=>{}),(e,t)=>{const _=G,p=z,U=K,c=Q,B=g;return D(),T("div",Z,[h("div",aa,[r(B,{"label-col":{span:5}},{default:o(()=>[r(p,f({ref:"name",label:"知识库名称"},v(d).library_name),{default:o(()=>[r(_,{value:a.library_name,"onUpdate:value":t[0]||(t[0]=i=>a.library_name=i),type:"text",placeholder:"请输入知识库名称，最多20个字",maxlength:20},null,8,["value"])]),_:1},16),r(p,{label:"知识库简介"},{default:o(()=>[r(U,{value:a.library_intro,"onUpdate:value":t[1]||(t[1]=i=>a.library_intro=i),placeholder:"请输入知识库介绍"},null,8,["value"])]),_:1}),r(p,f({ref:"name",label:"知识库封面"},v(d).avatar),{default:o(()=>[r($,{value:a.avatar,"onUpdate:value":t[2]||(t[2]=i=>a.avatar=i),onChange:F},null,8,["value"]),ea]),_:1},16),r(p,{"wrapper-col":{span:14,offset:4}},{default:o(()=>[r(c,{onClick:w},{default:o(()=>[y("取 消")]),_:1}),r(c,{type:"primary",style:{"margin-left":"16px"},loading:n.value,onClick:E(S,["prevent"])},{default:o(()=>[y("下一步")]),_:1},8,["loading"])]),_:1})]),_:1})])])}}},Da=j(ta,[["__scopeId","data-v-7ad9a1bd"]]);export{Da as default};
