import{C as Ke}from"./cu-scroll-ChKD2tbP.js";import{A as et,b as ce,k as V,d as Fe,M as ee,bq as tt,n as at,be as ie,T as _e,B as ot}from"../../index-DrRzkLrM.js";import{j as e,a3 as pe,a4 as me,r as b,A as Q,L as o,M as i,Q as s,V as t,U as st,u as q,a6 as p,P as T,F as z,_ as oe,a5 as Oe,Y as F,a9 as re,X as v,a0 as Se,a1 as Ie,b as lt,v as nt,B as it,$ as _t}from"./vue-chunks-Be7x44a8.js";import{i as se,r as dt,j as rt,k as ut,l as ct,m as pt}from"./index-DJ_e7lS-.js";import{U as Ue}from"./upload-input-Da-rBNKy.js";import{t as qe}from"./validate-8MtiUsxW.js";import{F as ue,_ as Me}from"./index-DiumbRRT.js";import"./index-CA_jlLpR.js";import{I as fe}from"./Input-BoEXW7Ed.js";import"./index-DLT3QCQZ.js";import{R as mt,_ as ft}from"./RadioButton-_CwniGKN.js";import{M as vt}from"./model-select-Br8n12E9.js";import{O as ht}from"./open-grapg-modal-B5Lq2onL.js";import{D as gt}from"./DownOutlined-Cp0vVtPD.js";import{U as yt}from"./UpOutlined-BEHaof9n.js";import{_ as kt}from"./index-Dq7pg9aM.js";import{S as De,_ as Te}from"./index-olzhrUzL.js";import{M as bt}from"./MoreOutlined-Bs3WvPot.js";import{_ as wt,M as xt}from"./index-KF-GLyjX.js";import"./index-DXP5TvMW.js";import{D as Ct}from"./dropdown-PWgKI0m8.js";import{S as $t}from"./index-CpDQkIaf.js";import{_ as qt}from"./index-_-lyLIzg.js";import{P as Lt}from"./PlusOutlined-BjJbDYD_.js";import{S as Ft}from"./SearchOutlined-CH2PxTj7.js";import{C as de}from"./ClockCircleFilled-DuXG7jku.js";import{_ as Ot}from"./index-BQkhi28h.js";import{_ as St}from"./index-DmIygWCJ.js";import{_ as It}from"./index-oRdc9kyy.js";import{a as Ut}from"./index-p4KXWPOV.js";import{_ as Mt}from"./TextArea-CnprCuXF.js";import"./pull-up.esm-JZ91zQ8P.js";import"./observe-dom.esm-DPKTicVt.js";import"./axios-Cm0UX6qg.js";import"./qs-DBZYvUeR.js";import"./crypto-js-5KTNdlTg.js";import"./dayjs-B2GD4xRt.js";import"./InboxOutlined-BeBrYwje.js";import"./index-DI5MN6Ih.js";import"./partition-wrgnp58x.js";import"./Trigger-QcvDPnyC.js";import"./Password-B58O6Jw3.js";import"./inputProps-D4I2pN7C.js";import"./CheckOutlined-CoztOWtC.js";import"./useRefs-Ctm-zX-7.js";import"./collapseMotion-D9n-d2nt.js";import"./FormItemContext-DlzjcwaL.js";import"./isPlainObject-BILoaqPQ.js";import"./responsiveObserve-Ca0NCZ8D.js";import"./QuestionCircleOutlined-C1VUeDko.js";import"./index-DtPUy1JV.js";import"./Search-Bp_yeyzm.js";import"./statusUtils-BM8Tk6m7.js";import"./index-BTuZjiB5.js";import"./slide-C3j77thT.js";import"./index-BFFBEz-T.js";import"./move-D51iXHK1.js";import"./shallowequal-COOgl3QP.js";import"./Dropdown-y3DQiBjQ.js";import"./RightOutlined-DqgahkKm.js";import"./colors-CGmsXzSB.js";import"./index-DrTRCjJ-.js";import"./index-DuwhI3lv.js";import"./useMaxLevel-Dylo0MFn.js";import"./index-Bug535t6.js";import"./css-grC2A7nw.js";import"./LeftOutlined-WF6BHmCW.js";import"./index-BFy9yLmi.js";var Dt={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M742 318V184h86c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H196c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h86v134c0 81.5 42.4 153.2 106.4 194-64 40.8-106.4 112.5-106.4 194v134h-86c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h632c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8h-86V706c0-81.5-42.4-153.2-106.4-194 64-40.8 106.4-112.5 106.4-194z"}}]},name:"hourglass",theme:"filled"};const Tt=Dt;function Le(y){for(var C=1;C<arguments.length;C++){var O=arguments[C]!=null?Object(arguments[C]):{},S=Object.keys(O);typeof Object.getOwnPropertySymbols=="function"&&(S=S.concat(Object.getOwnPropertySymbols(O).filter(function(P){return Object.getOwnPropertyDescriptor(O,P).enumerable}))),S.forEach(function(P){zt(y,P,O[P])})}return y}function zt(y,C,O){return C in y?Object.defineProperty(y,C,{value:O,enumerable:!0,configurable:!0,writable:!0}):y[C]=O,y}var ve=function(C,O){var S=Le({},C,O.attrs);return e(et,Le({},S,{icon:Tt}),null)};ve.displayName="HourglassFilled";ve.inheritAttrs=!1;const Nt=ve,Rt={class:"form-box"},Pt={class:"upload-document-type-box"},Et=["onClick"],Vt={class:"right-block"},At={class:"title-block"},Bt={class:"title-text"},Ht={class:"desc"},jt={__name:"add-custom-document",props:{libraryInfo:{type:Object,default:()=>{}}},emits:["ok"],setup(y,{expose:C,emit:O}){const S=pe(),P=me(),Y=ue.useForm,$=b(!1),c=b("添加自定义文档"),r=y,w=Q({library_id:P.query.id,doc_type:3,file_name:"",is_qa_doc:0,qa_index_type:1}),N=b([{iconName:"file-search",iconNameActive:"file-search",title:"问题与答案一起生成索引",value:1,desc:"回答用户提问时，将用户提问与导入的问题和答案一起对比相似度，根据相似度高的问题和答案回复"},{iconName:"comment-search",iconNameActive:"comment-search",title:"仅对问题生成索引",value:2,desc:"回答用户提问时，将用户提问与导入的问题一起对比相似度，再根据相似度高的问题和对应的答案来回复"}]),m=u=>{w.qa_index_type=u},B=Q({file_name:[{message:"请输入昵称",required:!0}]}),{resetFields:X,validate:H,validateInfos:x}=Y(w,B),j=()=>{$.value=!0,X(),w.file_name="",w.is_qa_doc=0,w.qa_index_type=1,r.libraryInfo.type==2&&(w.is_qa_doc=1)},R=b(!1),Z=()=>{H().then(()=>{let u={...re(w)};R.value=!0,se(u).then(d=>{V.success(`${c.value}成功`),$.value=!1,S.push("/library/preview?id="+d.data.file_ids[0])}).finally(()=>{R.value=!1})})};return C({add:j}),(u,d)=>{const I=fe,U=Me,M=mt,E=ft,J=Fe,h=ue,le=ee;return o(),i("div",null,[e(le,{open:$.value,"onUpdate:open":d[2]||(d[2]=_=>$.value=_),title:c.value,onOk:Z,width:"472px",confirmLoading:R.value},{default:s(()=>[t("div",Rt,[e(h,{layout:"vertical"},{default:s(()=>[e(U,st({label:"文档名称"},q(x).file_name),{default:s(()=>[e(I,{type:"text",placeholder:"请输入文档名称",value:w.file_name,"onUpdate:value":d[0]||(d[0]=_=>w.file_name=_)},null,8,["value"])]),_:1},16),p("",!0),w.is_qa_doc==1?(o(),T(U,{key:1,label:"索引方式",required:""},{default:s(()=>[t("div",Pt,[(o(!0),i(z,null,oe(N.value,_=>(o(),i("div",{class:Oe(["type-item",{active:w.qa_index_type==_.value}]),key:_.value,onClick:he=>m(_.value)},[t("div",Vt,[t("div",At,[e(J,{name:w.qa_index_type==_.value?_.iconNameActive:_.iconName},null,8,["name"]),t("div",Bt,F(_.title),1)]),t("div",Ht,F(_.desc),1)]),w.qa_index_type==_.value?(o(),T(J,{key:0,class:"check-arrow",name:"check-arrow-filled",style:{"font-size":"24px",color:"#fff"}})):p("",!0)],10,Et))),128))])]),_:1})):p("",!0)]),_:1})])]),_:1},8,["open","title","confirmLoading"])])}}},Gt=ce(jt,[["__scopeId","data-v-80f3643f"]]),W=y=>(Se("data-v-63c428fe"),y=y(),Ie(),y),Qt={class:"alert-box"},Yt=W(()=>t("div",null,[v(" 通过word或者EXce形式导入问答对，建议您参考"),t("a",{href:"https://xkf-upload-oss.xiaokefu.com.cn/static/chat-wiki/FAQ导入模板.docx"},"word导入模板"),v("  "),t("a",{href:"https://xkf-upload-oss.xiaokefu.com.cn/static/chat-wiki/FAQ 导入模板.xlsx"},"Excel导入模板"),v("创建导入文档 ")],-1)),Xt=W(()=>t("div",null,"如果您不是使用导入模板创建的文档，可以点击高级设置指定提取规则",-1)),Jt={class:"upload-file-box"},Wt={key:0,class:"hight-set"},Zt={key:0,class:"set-box"},Kt={class:"form-item"},ea=W(()=>t("div",{class:"form-item-label"},"问题所在列：",-1)),ta={class:"form-item-body"},aa={class:"form-item"},oa=W(()=>t("div",{class:"form-item-label"},"答案所在列：",-1)),sa={class:"form-item-body"},la={key:1,class:"set-box"},na={class:"form-item"},ia=W(()=>t("div",{class:"form-item-label"},"问题开始标识符：",-1)),_a={class:"form-item-body"},da={class:"form-item"},ra=W(()=>t("div",{class:"form-item-label"},"答案开始标识符：",-1)),ua={class:"form-item-body"},ca={__name:"qa-upload-modal",emits:["ok"],setup(y,{expose:C,emit:O}){const S=pe(),Y=me().query,$=b(!1),c=b(!1),r=b([]),w=O,N=b([]),m=Q({question_column:void 0,answer_column:void 0,question_lable:"问题：",answer_lable:"答案："}),B=b(!0),X=()=>{$.value=!0},H=()=>{let u=new FormData;r.value.forEach(d=>{u.append("library_files",d)}),dt(u).then(d=>{let I=[];for(let U in d.data)I.push({lable:d.data[U],value:U});N.value=I})},x=()=>{if(r.value.length==0){V.error("请选择文件");return}c.value=!0;let u=new FormData;u.append("library_id",Y.id);let d=!1;r.value.forEach(I=>{(I.name.includes(".xlsx")||I.name.includes(".csv"))&&(d=!0),u.append("library_files",I)}),d?(u.append("question_column",m.question_column),u.append("answer_column",m.answer_column)):(u.append("question_lable",m.question_lable),u.append("answer_lable",m.answer_lable)),u.append("is_qa_doc",1),se(u).then(I=>{w("ok"),$.value=!1,r.value=[],c.value=!1,d&&S.push("/library/document-segmentation?document_id="+I.data.file_ids[0])}).catch(()=>{c.value=!1})},j=()=>{r.value=[]},R=b(1),Z=u=>{m.question_column=void 0,m.answer_column=void 0,m.question_lable="问题：",m.answer_lable="答案：",r.value=u,u&&u.length>0&&(u[0].type.includes(".document")?R.value=2:(R.value=1,H()))};return C({show:X}),(u,d)=>{const I=kt,U=De,M=Te,E=fe,J=ee;return o(),i("div",null,[e(J,{width:680,open:$.value,"onUpdate:open":d[6]||(d[6]=h=>$.value=h),"confirm-loading":c.value,maskClosable:!1,title:"上传文档",onOk:x,onCancel:j},{default:s(()=>[t("div",Qt,[e(I,{"show-icon":""},{message:s(()=>[Yt,Xt]),_:1})]),t("div",Jt,[e(Ue,{type:2,value:r.value,"onUpdate:value":d[0]||(d[0]=h=>r.value=h),onChange:Z},null,8,["value"])]),r.value.length>0?(o(),i("div",Wt,[t("a",{onClick:d[1]||(d[1]=h=>B.value=!B.value)},[v("高级设置： "),B.value?(o(),T(q(yt),{key:1})):(o(),T(q(gt),{key:0}))]),B.value?(o(),i(z,{key:0},[R.value==1?(o(),i("div",Zt,[t("div",Kt,[ea,t("div",ta,[e(M,{value:m.question_column,"onUpdate:value":d[2]||(d[2]=h=>m.question_column=h),placeholder:"请选择列名",style:{width:"100%"}},{default:s(()=>[(o(!0),i(z,null,oe(N.value,h=>(o(),T(U,{value:h.value,key:h.value},{default:s(()=>[v(F(h.lable),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value"])])]),t("div",aa,[oa,t("div",sa,[e(M,{value:m.answer_column,"onUpdate:value":d[3]||(d[3]=h=>m.answer_column=h),placeholder:"请选择答案所在列",style:{width:"100%"}},{default:s(()=>[(o(!0),i(z,null,oe(N.value,h=>(o(),T(U,{value:h.value,key:h.value},{default:s(()=>[v(F(h.lable),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value"])])])])):p("",!0),R.value==2?(o(),i("div",la,[t("div",na,[ia,t("div",_a,[e(E,{placeholder:"请输入标识符",value:m.question_lable,"onUpdate:value":d[4]||(d[4]=h=>m.question_lable=h)},null,8,["value"])])]),t("div",da,[ra,t("div",ua,[e(E,{placeholder:"请输入标识符",value:m.answer_lable,"onUpdate:value":d[5]||(d[5]=h=>m.answer_lable=h)},null,8,["value"])])])])):p("",!0)],64)):p("",!0)])):p("",!0)]),_:1},8,["open","confirm-loading"])])}}},pa=ce(ca,[["__scopeId","data-v-63c428fe"]]),A=y=>(Se("data-v-b7148170"),y=y(),Ie(),y),ma={class:"details-library-page"},fa={class:"list-tools"},va={class:"tools-items"},ha={class:"tool-item"},ga={class:"dropdown-btn-menu"},ya=A(()=>t("div",{class:"title"},"本地文档",-1)),ka={key:0,class:"desc"},ba={key:1,class:"desc"},wa={class:"dropdown-btn-menu"},xa=A(()=>t("div",{class:"title"},"在线数据",-1)),Ca=A(()=>t("div",{class:"desc"},"获取在线网页内容",-1)),$a={class:"dropdown-btn-menu"},qa=A(()=>t("div",{class:"title"},"自定义文档",-1)),La=A(()=>t("div",{class:"desc"},"自定义一个空文档，手动添加内容",-1)),Fa=A(()=>t("span",null,"添加内容",-1)),Oa=A(()=>t("span",null,"嵌入模型：",-1)),Sa=A(()=>t("span",null,"生成知识图谱：",-1)),Ia={class:"tool-item"},Ua={class:"list-content"},Ma={key:0,class:"doc-name-td"},Da=["onClick"],Ta={key:0},za={key:1},Na={key:0,class:"url-remark"},Ra={key:0,class:"status-tag running"},Pa={key:1,class:"status-tag running"},Ea={key:2,class:"status-tag complete"},Va={class:"status-tag status-error"},Aa=["onClick"],Ba={class:"status-tag"},Ha=["onClick"],ja={key:5,class:"status-tag"},Ga={key:6,class:"status-tag running"},Qa={class:"status-tag error"},Ya={class:"status-tag"},Xa=["onClick"],Ja={key:1,class:"status-tag running"},Wa={key:2,class:"status-tag complete"},Za={class:"status-tag error"},Ka=["onClick"],eo={class:"zm-line1 reason-text"},to={key:4,class:"status-tag running"},ao={class:"status-tag warning"},oo={class:"reason-text"},so=["onClick"],lo={key:0},no={key:1},io={key:0},_o={key:1},ro=["onClick"],uo=A(()=>t("span",null,"删除",-1)),co={class:"upload-file-box"},po={class:"select-card-box"},mo=["onClick"],fo={class:"card-title"},vo={class:"card-desc"},ho={__name:"knowledge-document",setup(y){const C=[{key:2,title:"图文OCR解析",desc:"通过OCR文字识别提取pdf文件内容，可以兼容扫描件，但是解析速度较慢。"},{key:1,title:"纯文本解析",desc:"只提取pdf中的文字内容，如果文档为扫描件可能提取不到内容。"}],O=me(),S=pe(),P=O.query,Y=b(null),$=b(!1),c=b({library_intro:"",library_name:"",use_model:"",is_offline:null,type:0}),r=Q({use_model:"",model_config_id:""}),w=(a,l)=>{let g=l.modelName,L=l.modelId;H.value.length>0?ee.confirm({title:`确定切换模型为${g}吗？`,content:"切换后，所有学习文档将自动重新学习。",onOk(){r.use_model=g,r.model_config_id=L,N()},onCancel(){}}):(r.use_model=g,r.model_config_id=L,N())},N=(a=!0,l=null)=>{ut({...re(c.value),use_model:r.use_model,model_config_id:r.model_config_id}).then(()=>{c.value.use_model=r.use_model,c.value.model_config_id=r.model_config_id,typeof l=="function"&&l(),a&&V.success("保存成功")})},m=b([]),B=a=>{m.value=a,X()},X=()=>{if(!c.value.id){setTimeout(()=>{X()},100);return}if(m.value.length>0&&!c.value.use_model){let a=null,l=null;for(let g of m.value)if(g.model_define==="chatwiki"){a=g;for(let L of a.children)if(L.name==="text-embedding-v2"){l=L;break}break}a||(a=m.value[0],l=a.children[0]),a&&(r.use_model=l.name,r.model_config_id=l.model_config_id,N(!1))}},H=b([]),x=Q({library_id:P.id,file_name:void 0,page:1,size:10,total:0}),j=b([]),R=[{title:"文档名称",dataIndex:"file_name",key:"file_name",width:450},{title:"状态",dataIndex:"status",key:"status",width:180},{title:"知识图谱",dataIndex:"graph_status",key:"graph_status",width:200},{title:"文档格式",dataIndex:"file_ext",key:"file_ext",width:100},{title:"文档大小",dataIndex:"file_size_str",key:"file_size",width:100},{title:"分段",dataIndex:"paragraph_count",key:"paragraph_count",width:120},{title:"知识图谱实体数",dataIndex:"graph_entity_count",key:"graph_entity_count",width:160},{title:"更新时间",dataIndex:"update_time",key:"update_time",width:150},{title:"操作",dataIndex:"action",key:"action",width:100}],Z=a=>{x.page=a.current,x.size=a.pageSize,M()},u=()=>{x.page=1,M()};let d=!1;const I=({id:a})=>{H.value.length==1&&(d=!0),ct({id:a}).then(()=>{d&&x.page>1&&x.page--,M(),V.success("删除成功")})},U=(a,l={})=>{if(a.status=="4")return S.push({path:"/library/document-segmentation",query:{document_id:a.id}});if(a.status=="3"&&c.value.type!=2)return V.error("学习失败,不可预览");if(a.status=="0")return V.error("转换中,稍候可预览");if(a.status=="6")return V.error("获取中,不可预览");if(a.status=="7")return V.error("获取失败,不可预览");S.push({name:"libraryPreview",query:{id:a.id,...l}})},M=()=>{rt(re(x)).then(a=>{let l=a.data.info;!r.use_model&&r.use_model!=l.use_model&&(r.use_model=l.use_model,r.model_config_id=l.model_config_id),c.value={...l},$.value=l.graph_switch==1,l.graph_switch=="0"?j.value=R.filter(D=>!["graph_status","graph_entity_count"].includes(D.key)):j.value=R;let g=a.data.list||[];x.total=a.data.total;let L=!1;H.value=g.map(D=>(["1","6","0","5","4"].includes(D.status)&&(L=!0),D.file_size_str=tt(D.file_size),D.update_time=at(D.update_time*1e3).format("YYYY-MM-DD HH:mm"),D)),L&&J(),!L&&clearInterval(E.value)})},E=b(null),J=()=>{clearInterval(E.value),E.value=setInterval(()=>{M()},1e3*5)},h=b(null),le=a=>{if(m.value.length==0){ee.confirm({title:"请先到模型管理中添加嵌入模型？",content:"知识库学习需要使用到嵌入模型，请在系统管理-模型管理中添加。推荐使用通义千问、openai或者火山引擎的嵌入模型。",okText:"去添加",onOk(){S.push({path:"/user/model"})}});return}let{key:l}=a;l==1&&Re(),l==2&&he(),l==3&&h.value.add()},_=Q({open:!1,urls:"",library_id:P.id,doc_auto_renew_frequency:1,confirmLoading:!1,rules:{urls:[{message:"请输入网页地址",required:!0},{validator:(a,l)=>qe(l)===!1?Promise.reject(new Error("网页地址不合法")):Promise.resolve()}]}}),he=()=>{_.open=!0,_.confirmLoading=!1,_.urls="",_.doc_auto_renew_frequency=1},ge=b(null),ze=()=>{ge.value.validate().then(()=>{_.confirmLoading=!0,se({library_id:_.library_id,urls:JSON.stringify(qe(_.urls)),doc_auto_renew_frequency:_.doc_auto_renew_frequency,doc_type:2}).then(()=>{_.open=!1,_.confirmLoading=!1,u()})}).catch(()=>{_.confirmLoading=!1})},Ne=()=>{_.open=!1},k=Q({open:!1,fileList:[],confirmLoading:!1,pdf_parse_type:1}),ye=lt(()=>k.fileList.filter(a=>a.type==="application/pdf").length>0),ke=b(null),Re=()=>{if(c.value.type==2){ke.value.show();return}k.fileList=[],k.open=!0},Pe=()=>{k.fileList=[]},Ee=a=>{k.fileList=a},Ve=()=>{if(k.fileList.length==0){V.error("请选择文件");return}k.confirmLoading=!0;let a=new FormData;a.append("library_id",x.library_id);let l=!1;k.fileList.forEach(g=>{(g.name.includes(".xlsx")||g.name.includes(".csv"))&&(l=!0),a.append("library_files",g)}),ye.value&&a.append("pdf_parse_type",k.pdf_parse_type),se(a).then(g=>{M(),k.open=!1,k.fileList=[],k.confirmLoading=!1,l&&S.push("/library/document-segmentation?document_id="+g.data.file_ids[0])}).catch(()=>{k.confirmLoading=!1})},be=a=>{pt({id:a.id}).then(()=>{M()})},Ae=()=>{if($.value){$.value=!1;let a={graph_model_config_id:c.value.graph_model_config_id,graph_use_model:c.value.graph_use_model};if((!a.graph_model_config_id||!a.graph_use_model)&&m.value.length>0){let g=m.value[0].children[0];a.graph_use_model=g.name,a.graph_model_config_id=g.model_config_id}Y.value.show(a)}else c.value.graph_switch=0,N(!1,()=>{M()})},Be=a=>{$.value=!0,c.value.graph_switch=1,c.value.graph_model_config_id=a.graph_model_config_id,c.value.graph_use_model=a.graph_use_model,N(!1,()=>{M()})},He=a=>{k.pdf_parse_type=a.key};return nt(()=>{M()}),it(()=>{E.value&&clearInterval(E.value)}),(a,l)=>{const g=Fe,L=Ot,D=wt,we=xt,je=ot,xe=Ct,Ge=St,Qe=fe,te=$t,ne=It,Ye=qt,Xe=Ut,Je=Ke,ae=Me,Ce=ue,$e=ee,We=Mt,K=De,Ze=Te;return o(),i("div",ma,[e(Je,{scrollbar:!1},{default:s(()=>[t("div",fa,[t("div",va,[t("div",ha,[e(xe,{trigger:["click"],overlayClassName:"add-dropdown-btn"},{overlay:s(()=>[e(we,{onClick:le},{default:s(()=>[(o(),T(D,{key:1},{default:s(()=>[t("div",ga,[e(L,{class:"title-block",gap:4},{default:s(()=>[e(g,{name:"doc-icon"}),ya]),_:1}),c.value.type==2?(o(),i("div",ka,"上传本地 docx/csv/xlsx 等格式文件")):(o(),i("div",ba,"上传本地 pdf/docx/ofd/txt/md/xlsx/csv/html 等格式文件"))])]),_:1})),c.value.type!=2?(o(),T(D,{key:2},{default:s(()=>[t("div",wa,[e(L,{class:"title-block",gap:4},{default:s(()=>[e(g,{name:"link-icon"}),xa]),_:1}),Ca])]),_:1})):p("",!0),(o(),T(D,{key:3},{default:s(()=>[t("div",$a,[e(L,{class:"title-block",gap:4},{default:s(()=>[e(g,{name:"cu-doc-icon"}),qa]),_:1}),La])]),_:1}))]),_:1})]),default:s(()=>[e(je,{type:"primary"},{icon:s(()=>[e(q(Lt))]),default:s(()=>[Fa]),_:1})]),_:1})]),e(L,{align:"center",class:"tool-item custom-select-box"},{default:s(()=>[Oa,e(vt,{modelType:"TEXT EMBEDDING",isOffline:!1,modeName:r.use_model,modeId:r.model_config_id,style:{width:"240px"},onChange:w,onLoaded:B},null,8,["modeName","modeId"])]),_:1}),e(L,{align:"center",class:"tool-item custom-select-box pd-5-8"},{default:s(()=>[Sa,e(Ge,{checked:$.value,"onUpdate:checked":l[0]||(l[0]=f=>$.value=f),onChange:Ae,"checked-children":"开","un-checked-children":"关"},null,8,["checked"])]),_:1})]),t("div",null,[t("div",Ia,[e(Qe,{style:{width:"282px"},value:x.file_name,"onUpdate:value":l[1]||(l[1]=f=>x.file_name=f),placeholder:"请输入文档名称搜索",onChange:u},{suffix:s(()=>[e(q(Ft),{onClick:u,style:{color:"rgba(0, 0, 0, 0.25)"}})]),_:1},8,["value"])])])]),t("div",Ua,[e(Xe,{columns:j.value,"data-source":H.value,pagination:{current:x.page,total:x.total,pageSize:x.size,showQuickJumper:!0,showSizeChanger:!0,pageSizeOptions:["10","20","50","100"]},onChange:Z},{bodyCell:s(({column:f,record:n})=>[f.key==="file_name"?(o(),i("div",Ma,[t("a",{onClick:G=>U(n)},[["5","6","7"].includes(n.status)?(o(),i("span",Ta,F(n.doc_url),1)):(o(),i("span",za,F(n.file_name),1))],8,Da),n.doc_type==2&&n.remark?(o(),i("div",Na," 备注："+F(n.remark),1)):p("",!0)])):p("",!0),f.key==="status"?(o(),i(z,{key:1},[n.status==0?(o(),i("span",Ra,[e(te,{size:"small"}),v(" 转换中")])):p("",!0),n.status==1?(o(),i("span",Pa,[e(te,{size:"small"}),v(" 学习中")])):p("",!0),n.status==2?(o(),i("span",Ea,[e(q(ie)),v(" 学习完成")])):p("",!0),n.status==3?(o(),T(ne,{key:3,placement:"top"},{title:s(()=>[t("span",null,F(n.errmsg),1)]),default:s(()=>[t("span",null,[t("span",Va,[e(q(_e)),v(" 学习失败")]),c.value.type==2?(o(),i("a",{key:0,class:"ml8",onClick:G=>U(n)},"学习",8,Aa)):p("",!0)])]),_:2},1024)):p("",!0),n.status==4?(o(),i(z,{key:4},[t("span",Ba,[e(q(de)),v(" 待学习")]),t("a",{class:"ml8",onClick:G=>U(n)},"学习",8,Ha)],64)):p("",!0),n.status==5?(o(),i("span",ja,[e(q(de)),v(" 待获取")])):p("",!0),n.status==6?(o(),i("span",Ga,[e(te,{size:"small"}),v(" 获取中")])):p("",!0),n.status==7?(o(),T(ne,{key:7,placement:"top"},{title:s(()=>[t("span",null,F(n.errmsg),1)]),default:s(()=>[t("span",Qa,[e(q(_e)),v(" 获取失败")])]),_:2},1024)):p("",!0)],64)):p("",!0),f.key==="graph_status"?(o(),i(z,{key:2},[n.graph_status==0?(o(),i(z,{key:0},[t("span",Ya,[e(q(de)),v(" 待生成")]),t("a",{class:"ml8",onClick:G=>be(n)},"生成",8,Xa)],64)):n.graph_status==1?(o(),i("span",Ja,[e(q(Nt)),v(" 排队中")])):n.graph_status==2?(o(),i("span",Wa,[e(q(ie)),v(" 生成完成")])):n.graph_status==3?(o(),i(z,{key:3},[t("span",Za,[e(q(_e)),v(" 生成失败")]),t("a",{class:"ml8",onClick:G=>be(n)},"生成",8,Ka),n.graph_err_msg?(o(),T(ne,{key:0,title:n.graph_err_msg},{default:s(()=>[t("div",eo,"原因："+F(n.graph_err_msg),1)]),_:2},1032,["title"])):p("",!0)],64)):n.graph_status==4?(o(),i("span",to,[e(te,{size:"small"}),v(" 生成中")])):n.graph_status==5?(o(),i(z,{key:5},[t("span",ao,[e(q(ie)),v(" 部分成功")]),t("div",oo,[v(" 失败数："+F(n.graph_err_count||0)+" ",1),t("a",{class:"ml8",onClick:G=>U(n,{graph_status:3})},"详情",8,so)])],64)):p("",!0)],64)):p("",!0),f.key==="file_size"?(o(),i(z,{key:3},[n.doc_type==3?(o(),i("span",lo,"-")):(o(),i("span",no,F(n.file_size_str),1))],64)):p("",!0),f.key==="paragraph_count"?(o(),i(z,{key:4},[n.status==0||n.status==1?(o(),i("span",io,"-")):(o(),i("span",_o,F(n.paragraph_count),1))],64)):p("",!0),f.key==="action"?(o(),T(xe,{key:5},{overlay:s(()=>[e(we,null,{default:s(()=>[e(D,{disabled:n.status==6||n.status==7||n.status==0},{default:s(()=>[t("div",{onClick:G=>U(n)},"预览",8,ro)]),_:2},1032,["disabled"]),e(D,null,{default:s(()=>[e(Ye,{title:"确定要删除吗?",onConfirm:G=>I(n)},{default:s(()=>[uo]),_:2},1032,["onConfirm"])]),_:2},1024)]),_:2},1024)]),default:s(()=>[t("div",{class:"table-btn",onClick:l[2]||(l[2]=_t(()=>{},["prevent"]))},[e(q(bt))])]),_:2},1024)):p("",!0)]),_:1},8,["columns","data-source","pagination"])])]),_:1}),e($e,{open:k.open,"onUpdate:open":l[4]||(l[4]=f=>k.open=f),"confirm-loading":k.confirmLoading,maskClosable:!1,title:"上传文档",onOk:Ve,onCancel:Pe,width:"740px"},{default:s(()=>[e(Ce,{class:"mt24","label-col":{span:4},"wrapper-col":{span:20}},{default:s(()=>[e(ae,{required:"",label:"上传文档"},{default:s(()=>[t("div",co,[e(Ue,{type:c.value.type,value:k.fileList,"onUpdate:value":l[3]||(l[3]=f=>k.fileList=f),onChange:Ee},null,8,["type","value"])])]),_:1}),ye.value?(o(),T(ae,{key:0,required:"",label:"PDF解析模式"},{default:s(()=>[t("div",po,[(o(),i(z,null,oe(C,f=>t("div",{key:f.key,class:Oe(["select-card-item",{active:k.pdf_parse_type==f.key}]),onClick:n=>He(f)},[e(g,{class:"check-arrow",name:"check-arrow-filled"}),t("div",fo,F(f.title),1),t("div",vo,F(f.desc),1)],10,mo)),64))])]),_:1})):p("",!0)]),_:1})]),_:1},8,["open","confirm-loading"]),e(pa,{onOk:M,ref_key:"qaUploadModalRef",ref:ke},null,512),e($e,{open:_.open,"onUpdate:open":l[7]||(l[7]=f=>_.open=f),"confirm-loading":_.confirmLoading,maskClosable:!1,title:"添加在线数据",width:"746px",onOk:ze,onCancel:Ne},{default:s(()=>[e(Ce,{class:"url-add-form",layout:"vertical",ref_key:"urlFormRef",ref:ge,model:_,rules:_.rules},{default:s(()=>[e(ae,{name:"urls",label:"网页链接"},{default:s(()=>[e(We,{style:{height:"120px"},value:_.urls,"onUpdate:value":l[5]||(l[5]=f=>_.urls=f),placeholder:"请输入网页链接,形式：一行标题一行网页链接"},null,8,["value"])]),_:1}),e(ae,{name:"doc_auto_renew_frequency",label:"更新频率",required:""},{default:s(()=>[e(Ze,{value:_.doc_auto_renew_frequency,"onUpdate:value":l[6]||(l[6]=f=>_.doc_auto_renew_frequency=f),style:{width:"100%"}},{default:s(()=>[e(K,{value:1},{default:s(()=>[v("不自动更新")]),_:1}),e(K,{value:2},{default:s(()=>[v("每天")]),_:1}),e(K,{value:3},{default:s(()=>[v("每3天")]),_:1}),e(K,{value:4},{default:s(()=>[v("每7天")]),_:1}),e(K,{value:5},{default:s(()=>[v("每30天")]),_:1})]),_:1},8,["value"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["open","confirm-loading"]),e(Gt,{libraryInfo:c.value,onOk:u,ref_key:"addCustomDocumentRef",ref:h},null,8,["libraryInfo"]),e(ht,{onOk:Be,ref_key:"openGrapgModalRef",ref:Y},null,512)])}}},Us=ce(ho,[["__scopeId","data-v-b7148170"]]);export{Us as default};
