import{r as C,a0 as T,A as L,L as m,M as f,j as t,Q as e,ac as R,ae as M,u as s,X as a,F as U,a1 as Z,Y as c,a3 as z,a4 as A,V as r}from"./vue-chunks-C0QQWOCx.js";import{c as ee,f as te,u as oe,h as ne}from"./index-Cuemeb_K.js";import{_ as D,e as P,M as E,B as ae,E as ie}from"../../index-BNfL3w2j.js";import{F as N,_ as le}from"./index-yFqc4cD2.js";import"./index-BoBIAv4a.js";import{I as se}from"./Input-CkTCA1H7.js";import{Q as p}from"./QuestionCircleOutlined-4KQaJWl2.js";import{_ as Q}from"./index-3k2SlWGM.js";import{S as re,_ as de}from"./index-0s7_DZpf.js";import{_ as j}from"./index-ISsoQRoP.js";import{a as ue,_ as pe}from"./index-BOxUYg9b.js";import{P as _e}from"./PlusOutlined-B5cXtakc.js";import{_ as ce}from"./index-BszAReYL.js";import"./axios-Cm0UX6qg.js";import"./qs-CnxcMLjH.js";import"./crypto-js-C2SrYqGA.js";import"./dayjs-CsGPDCY7.js";import"./colors-B6m1To83.js";import"./isPlainObject-B4InAXj5.js";import"./responsiveObserve-BS_1XHbF.js";import"./collapseMotion-BOXZQl9Y.js";import"./FormItemContext-DCiQBKp-.js";import"./index-CqC-D0MF.js";import"./Search-DP6Te_4V.js";import"./SearchOutlined-COjt0mX8.js";import"./inputProps-CkRR1l6t.js";import"./TextArea-Cl8pxwyC.js";import"./statusUtils-D6YMZbpq.js";import"./index-B4Ve0Gtb.js";import"./Password-C3rJAIql.js";import"./slide-jWfiTdSY.js";import"./isMobile-D_4OiXLP.js";import"./CheckOutlined-D8d6FGqD.js";import"./DownOutlined-DZkW1qbV.js";import"./move-Bt6G5yRx.js";import"./index-0xdjx3xw.js";import"./useMaxLevel-Dv7R3ypw.js";import"./index-BQz4ljyr.js";import"./css-grC2A7nw.js";import"./index-Dhs-V5_s.js";import"./LeftOutlined-C1uATSBJ.js";import"./RightOutlined-DnfX1v3R.js";import"./index-BPxS37Xo.js";import"./RadioButton-DYoB577d.js";import"./index-DQEK_4Ml.js";import"./dropdown-cgG4KqwT.js";import"./Dropdown-BO8OtH1l.js";import"./index-bCnK99Cb.js";import"./shallowequal-Fk1l6xhN.js";import"./index-C-pm-tzm.js";const J=d=>(z("data-v-85152a05"),d=d(),A(),d),me={class:"add-data-sheet"},fe=J(()=>r("div",null,"必要字段：在保存一行数据时，必须提供对应字段信息，否则无法保存该行数据",-1)),he=J(()=>r("div",null,"非必要字段：缺失该字段信息时，一行数据仍可被保存在表中",-1)),ve={__name:"add-field-modal",emits:["ok"],setup(d,{expose:V,emit:q}){const k=C("添加字段"),$=T().query,h=C(!1),x=q,F=[{label:"string",value:"string"},{label:"integer",value:"integer"},{label:"number",value:"number"},{label:"boolean",value:"boolean"}],o=L({name:"",description:"",type:void 0,required:"false",form_id:$.form_id,id:""}),v=n=>{h.value=!0,_(),o.name=n.name||"",o.description=n.description||"",o.type=n.type,o.required=n.required,o.id=n.id||"",k.value=n.id?"编辑字段":"添加字段"},O=L({name:[{required:!0,validator:async(n,i)=>/^[a-z][a-z0-9_]*$/.test(i)?Promise.resolve():Promise.reject("必须以英文字母开头，只能包含小写字母、数字、下划线")}],description:[{required:!0,message:"请输入字段描述"}],type:[{required:!0,message:"请选择数据类型"}]}),u=N.useForm,{resetFields:_,validate:S,validateInfos:g}=u(o,O),I=()=>{S().then(()=>{ee(o).then(n=>{let i=o.id?"修改成功":"新增成功";P.success(i),h.value=!1,x("ok")})})};return V({show:v}),(n,i)=>{const b=Q,B=se,w=le,Y=re,G=de,H=j,K=N,W=E;return m(),f("div",me,[t(W,{open:h.value,"onUpdate:open":i[4]||(i[4]=l=>h.value=l),title:k.value,onOk:I,width:540},{default:e(()=>[t(K,{layout:"vertical"},{default:e(()=>[t(w,R(M(s(g).name)),{label:e(()=>[a("字段名称  "),t(b,null,{title:e(()=>[a("定义数据表的表头，可以在对应表头下存储相关数据。")]),default:e(()=>[t(s(p))]),_:1})]),default:e(()=>[t(B,{maxLength:64,value:o.name,"onUpdate:value":i[0]||(i[0]=l=>o.name=l),placeholder:"请输入字段名称"},null,8,["value"])]),_:1},16),t(w,R(M(s(g).description)),{label:e(()=>[a("字段描述  "),t(b,null,{title:e(()=>[a("表头字段的说明，帮助用户或大模型理解表头字段")]),default:e(()=>[t(s(p))]),_:1})]),default:e(()=>[t(B,{maxLength:64,value:o.description,"onUpdate:value":i[1]||(i[1]=l=>o.description=l),placeholder:"请输入字段描述"},null,8,["value"])]),_:1},16),t(w,R(M(s(g).type)),{label:e(()=>[a("数据类型  "),t(b,null,{title:e(()=>[a("选择存储字段对应的数据类型")]),default:e(()=>[t(s(p))]),_:1})]),default:e(()=>[t(G,{value:o.type,"onUpdate:value":i[2]||(i[2]=l=>o.type=l),style:{width:"100%"},placeholder:"请选择数据类型"},{default:e(()=>[(m(),f(U,null,Z(F,l=>t(Y,{value:l.value,key:l.value},{default:e(()=>[a(c(l.label),1)]),_:2},1032,["value"])),64))]),_:1},8,["value"])]),_:1},16),t(w,null,{label:e(()=>[a("是否必要  "),t(b,null,{title:e(()=>[fe,he]),default:e(()=>[t(s(p))]),_:1})]),default:e(()=>[t(H,{checked:o.required,"onUpdate:checked":i[3]||(i[3]=l=>o.required=l),"checked-children":"开","un-checked-children":"关",checkedValue:"true",unCheckedValue:"false"},null,8,["checked"])]),_:1})]),_:1})]),_:1},8,["open","title"])])}}},ke=D(ve,[["__scopeId","data-v-85152a05"]]),X=d=>(z("data-v-7f6a3079"),d=d(),A(),d),ye={class:"field-manage-page"},ge={class:"page-title"},qe={class:"table-wrapper customize-scroll-style"},xe={key:0},Fe={key:1},be={key:0},we={key:1},Ce=X(()=>r("div",null,"必要字段：在保存一行数据时，必须提供对应字段信息，否则无法保存该行数据",-1)),$e=X(()=>r("div",null,"非必要字段：缺失该字段信息时，一行数据仍可被保存在表中",-1)),Oe=["onClick"],Se=["onClick"],Ie={__name:"index",setup(d){const q=T().query,k=C([]),y=()=>{te({form_id:q.form_id}).then(o=>{k.value=o.data||[]})};y();const $=o=>{oe({id:o.id,form_id:q.form_id,required:o.required=="true"?"false":"true"}).then(v=>{P.success("修改成功"),y()})},h=o=>{E.confirm({title:"删除确认",icon:t(ie),content:`删除后，字段下所有数据将一并删除，删除后不可恢复。确认删除字段${o.name}吗?`,okText:"确 定",okType:"danger",cancelText:"取 消",onOk(){ne({id:o.id}).then(v=>{P.success("删除成功"),y()})},onCancel(){}})},x=C(null),F=(o={})=>{x.value.show(JSON.parse(JSON.stringify(o)))};return(o,v)=>{const O=ae,u=Q,_=pe,S=j,g=ce,I=ue;return m(),f(U,null,[r("div",ye,[r("div",ge,[a(" 字段管理 "),t(O,{type:"primary",onClick:v[0]||(v[0]=n=>F())},{icon:e(()=>[t(s(_e))]),default:e(()=>[a(" 添加字段 ")]),_:1})]),r("div",qe,[t(I,{pagination:!1,"data-source":k.value},{default:e(()=>[t(_,{key:"name","data-index":"name",width:150},{title:e(()=>[a(" 字段名称 "),t(u,null,{title:e(()=>[a("定义数据表的表头，可以在对应表头下存储相关数据。")]),default:e(()=>[t(s(p))]),_:1})]),default:e(({record:n})=>[n.name.length>50?(m(),f("span",xe,[t(u,null,{title:e(()=>[a(c(n.name),1)]),default:e(()=>[a(" "+c(n.name.slice(0,50)+"..."),1)]),_:2},1024)])):(m(),f("span",Fe,c(n.name),1))]),_:1}),t(_,{key:"description","data-index":"description",width:150},{title:e(()=>[a(" 字段描述 "),t(u,null,{title:e(()=>[a("表头字段的说明，帮助用户或大模型理解表头字段")]),default:e(()=>[t(s(p))]),_:1})]),default:e(({record:n})=>[n.description.length>50?(m(),f("span",be,[t(u,null,{title:e(()=>[a(c(n.description),1)]),default:e(()=>[a(" "+c(n.description.slice(0,50)+"..."),1)]),_:2},1024)])):(m(),f("span",we,c(n.description),1))]),_:1}),t(_,{key:"type","data-index":"type",width:120},{title:e(()=>[a(" 数据类型 "),t(u,null,{title:e(()=>[a("选择存储字段对应的数据类型")]),default:e(()=>[t(s(p))]),_:1})]),_:1}),t(_,{key:"required","data-index":"required",width:120},{title:e(()=>[a(" 是否必要 "),t(u,null,{title:e(()=>[Ce,$e]),default:e(()=>[t(s(p))]),_:1})]),default:e(({record:n})=>[t(S,{onChange:i=>$(n),checked:n.required=="true","checked-children":"开","un-checked-children":"关"},null,8,["onChange","checked"])]),_:1}),t(_,{key:"action",title:"操作",width:90},{default:e(({record:n})=>[r("span",null,[r("a",{onClick:i=>F(n)},"编辑",8,Oe),t(g,{type:"vertical"}),r("a",{onClick:i=>h(n)},"删除",8,Se)])]),_:1})]),_:1},8,["data-source"])])]),t(ke,{onOk:y,ref_key:"addFieldModalRef",ref:x},null,512)],64)}}},$t=D(Ie,[["__scopeId","data-v-7f6a3079"]]);export{$t as default};
