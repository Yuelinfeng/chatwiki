import{L as k,M as w,F as Q,_ as X,V as t,Y as x,$,j as o,Q as l,a3 as M,r as L,b as K,A as D,v as W,P as Z,U as B,u as C,a0 as O,a1 as F,X as ee}from"./vue-chunks-Be7x44a8.js";import{c as te,g as ae,d as oe}from"./index-DJ_e7lS-.js";import{b as q,d as se,k as I,bo as N,br as R,M as E,cJ as ne,bq as re,E as ie,B as le}from"../../index-DrRzkLrM.js";import{_ as de,M as _e}from"./index-KF-GLyjX.js";import"./index-DXP5TvMW.js";import{D as ce}from"./dropdown-PWgKI0m8.js";import{t as pe}from"./validate-8MtiUsxW.js";import{A as me}from"./avatar-input-4lpsnDCH.js";import{F as S,_ as ue}from"./index-DiumbRRT.js";import"./index-CA_jlLpR.js";import{I as fe}from"./Input-BoEXW7Ed.js";import{_ as ve}from"./TextArea-CnprCuXF.js";import{_ as ye}from"./page-alert-BASYyI6C.js";import{P as be}from"./PlusOutlined-BjJbDYD_.js";import"./axios-Cm0UX6qg.js";import"./qs-DBZYvUeR.js";import"./crypto-js-5KTNdlTg.js";import"./dayjs-B2GD4xRt.js";import"./shallowequal-COOgl3QP.js";import"./Trigger-QcvDPnyC.js";import"./collapseMotion-D9n-d2nt.js";import"./slide-C3j77thT.js";import"./index-BFFBEz-T.js";import"./index-oRdc9kyy.js";import"./colors-CGmsXzSB.js";import"./Dropdown-y3DQiBjQ.js";import"./RightOutlined-DqgahkKm.js";import"./move-D51iXHK1.js";import"./index-DI5MN6Ih.js";import"./partition-wrgnp58x.js";import"./Password-B58O6Jw3.js";import"./inputProps-D4I2pN7C.js";import"./CheckOutlined-CoztOWtC.js";import"./useRefs-Ctm-zX-7.js";import"./FormItemContext-DlzjcwaL.js";import"./isPlainObject-BILoaqPQ.js";import"./responsiveObserve-Ca0NCZ8D.js";import"./QuestionCircleOutlined-C1VUeDko.js";import"./index-DtPUy1JV.js";import"./Search-Bp_yeyzm.js";import"./SearchOutlined-CH2PxTj7.js";import"./statusUtils-BM8Tk6m7.js";const he={class:"list-box"},ge=["onClick"],xe={class:"library-info"},ke=["src"],$e={class:"library-info-content"},we={class:"library-title"},Le={class:"item-body"},Ae={class:"library-desc"},Ce={class:"item-footer"},Ie={class:"library-size"},qe={class:"text-item"},De={class:"text-item"},Be=["onClick"],Se=["onClick"],Me={__name:"index",props:{list:{type:Array,default:()=>[]},showCreate:{type:Boolean,default:!0}},emits:["add","edit","delete"],setup(d,{emit:h}){const f=h,_=d,c=p=>{f("edit",p)},m=p=>{f("delete",p)};return(p,u)=>{const v=se,s=de,e=_e,r=ce;return k(),w("div",he,[(k(!0),w(Q,null,X(_.list,n=>(k(),w("div",{class:"list-item-wrapper",key:n.id},[t("div",{class:"list-item",onClick:$(g=>c(n),["stop"])},[t("div",xe,[t("img",{class:"library-icon",src:n.avatar,alt:""},null,8,ke),t("div",$e,[t("div",we,x(n.library_name),1)])]),t("div",Le,[t("div",Ae,x(n.library_intro),1)]),t("div",Ce,[t("div",Ie,[t("span",qe,"文档："+x(n.file_total),1),t("span",De,"大小："+x(n.file_size_str),1)]),t("div",{class:"action-box",onClick:u[1]||(u[1]=$(()=>{},["stop"]))},[o(r,null,{overlay:l(()=>[o(e,null,{default:l(()=>[o(s,null,{default:l(()=>[t("a",{href:"javascript:;",onClick:$(g=>c(n),["stop"])},"管 理",8,Be)]),_:2},1024),o(s,null,{default:l(()=>[t("a",{class:"delete-text-color",href:"javascript:;",onClick:g=>m(n)},"删 除",8,Se)]),_:2},1024)]),_:2},1024)]),default:l(()=>[t("div",{class:"action-item",onClick:u[0]||(u[0]=$(()=>{},["stop"]))},[o(v,{class:"action-icon",name:"point-h"})])]),_:2},1024)])])],8,ge)]))),128))])}}},Oe=q(Me,[["__scopeId","data-v-8d366fcc"]]),Fe=d=>(O("data-v-17846dfc"),d=d(),F(),d),Ne={class:"form-box"},Re=Fe(()=>t("div",{class:"form-item-tip"},"请上传知识库封面，建议尺寸为100*100px.大小不超过100kb",-1)),Ee={__name:"add-library-model",setup(d,{expose:h}){I.config({duration:2});const f=M(),_=L(!1),c=K(()=>1);let m="",p="";const u=S.useForm,v=L(!1),s=c.value==0?N:R,e=D({type:c.value,access_rights:0,library_name:"",library_intro:"",use_model:"",model_config_id:"",library_files:void 0,avatar:s,avatar_file:void 0,is_offline:!1,urls:"",doc_type:1,file_name:"",is_qa_doc:c.value==2?1:0,qa_index_type:1,doc_auto_renew_frequency:1}),r=D({library_name:[{required:!0,message:"请输入库名称",trigger:"change"}]}),{validate:n,validateInfos:g}=u(e,r),P=a=>{e.avatar=a.imageUrl,e.avatar_file=a.file},U=()=>{_.value=!1},V=()=>{n().then(()=>{z()}).catch(a=>{})},z=()=>{let a=new FormData,i=JSON.parse(JSON.stringify(e));a.append("type",e.type),a.append("access_rights",e.access_rights),a.append("library_name",e.library_name),a.append("library_intro",e.library_intro),a.append("use_model",i.use_model),a.append("model_config_id",e.model_config_id),a.append("avatar",e.avatar_file?e.avatar_file:""),a.append("is_offline",e.is_offline),a.append("urls",JSON.stringify(pe(e.urls))),a.append("doc_type",e.doc_type),a.append("file_name",e.file_name),a.append("is_qa_doc",e.is_qa_doc),a.append("qa_index_type",e.qa_index_type),a.append("doc_auto_renew_frequency",e.doc_auto_renew_frequency),v.value=!0,te(a).then(b=>{I.success("创建成功"),p=b.data.id,m=b.data.library_key,j(b.data.id)}).catch(()=>{v.value=!1})},J=async()=>await ne({library_key:m,doc_id:"",doc_type:"4",pid:0,title:"无标题文档",content:"# 无标题文档",sort:0}),j=()=>{J().then(a=>{let i=a.data.doc_id;f.replace({path:"/public-library/editor",query:{library_id:p,library_key:m,doc_id:i}})})};return h({show:()=>{_.value=!0}}),W(()=>{}),(a,i)=>{const b=fe,A=ue,Y=ve,G=S,H=E;return k(),Z(H,{open:_.value,"onUpdate:open":i[3]||(i[3]=y=>_.value=y),title:"添加知识库",onOk:V,confirmLoading:v.value,onCancel:U,width:"640px"},{default:l(()=>[t("div",Ne,[o(G,{"label-col":{span:5}},{default:l(()=>[o(A,B({ref:"name",label:"知识库名称"},C(g).library_name),{default:l(()=>[o(b,{value:e.library_name,"onUpdate:value":i[0]||(i[0]=y=>e.library_name=y),type:"text",placeholder:"请输入知识库名称，最多20个字",maxlength:20},null,8,["value"])]),_:1},16),o(A,{label:"知识库简介"},{default:l(()=>[o(Y,{maxlength:1e3,value:e.library_intro,"onUpdate:value":i[1]||(i[1]=y=>e.library_intro=y),placeholder:"请输入知识库介绍"},null,8,["value"])]),_:1}),o(A,B({ref:"name",label:"知识库封面"},C(g).avatar),{default:l(()=>[o(me,{value:e.avatar,"onUpdate:value":i[2]||(i[2]=y=>e.avatar=y),onChange:P},null,8,["value"]),Re]),_:1},16)]),_:1})])]),_:1},8,["open","confirmLoading"])}}},Te=q(Ee,[["__scopeId","data-v-17846dfc"]]),T=d=>(O("data-v-feb71ea3"),d=d(),F(),d),Pe={"bg-color":"#f5f9ff",class:"library-page"},Ue=T(()=>t("div",{class:"page-title"},"对外文档",-1)),Ve=T(()=>t("div",null,[t("p",null," 1、对外文档作为在线文档创作管理工具，创作的文档既可作为知识库关联到机器人使用，也可分享给好友查看。 "),t("p",null,"2、支持设置每篇文档的title、description、keyword，提高SEO搜索权重。")],-1)),ze={class:"library-page-body"},Je={class:"list-toolbar"},je={class:"toolbar-box"},Ye={class:"list-total"},Ge={class:"toolbar-box"},He={__name:"index",setup(d){const h=M(),f=L(null),_=L([]),c=()=>{ae({type:1}).then(s=>{let e=s.data||[];e.forEach(r=>{r.file_size_str=re(r.file_size),r.avatar||(r.avatar=r.type==0?N:R)}),_.value=e})};c();const m=()=>{f.value.show()},p=s=>{h.push({path:"/public-library/home",query:{library_id:s.id,library_key:s.library_key}})},u=s=>{let e=3,r=E.confirm({title:`删除${s.library_name}`,icon:o(ie),content:"您确定要删除此知识库吗？",okText:e+" 确 定",okType:"danger",okButtonProps:{disabled:!0},cancelText:"取 消",onOk(){v(s)},onCancel(){}}),n=setInterval(()=>{e==1?(r.update({okText:"确 定",okButtonProps:{disabled:!1}}),clearInterval(n),n=void 0):(e-=1,r.update({okText:e+" 确 定",okButtonProps:{disabled:!0}}))},1e3)},v=({id:s})=>{oe({id:s}).then(()=>{I.success("删除成功"),c()})};return(s,e)=>{const r=le;return k(),w("div",Pe,[Ue,o(ye,{style:{"margin-bottom":"16px"},title:"使用说明"},{default:l(()=>[Ve]),_:1}),t("div",ze,[t("div",Je,[t("div",je,[t("h3",Ye,"全部 ("+x(_.value.length)+")",1)]),t("div",Ge,[o(r,{type:"primary",onClick:e[0]||(e[0]=n=>m())},{icon:l(()=>[o(C(be))]),default:l(()=>[ee(" 新建对外文档 ")]),_:1})])]),t("div",null,[o(Oe,{list:_.value,onAdd:m,onEdit:p,onDelete:u},null,8,["list"])])]),o(Te,{ref_key:"addLibraryModelRef",ref:f},null,512)])}}},Et=q(He,[["__scopeId","data-v-feb71ea3"]]);export{Et as default};
