!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.FetchEventSource=t():e.FetchEventSource=t()}(this,(()=>(()=>{"use strict";var e={443:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getMessages=t.getLines=t.getBytes=void 0,t.getBytes=async function(e,t){const n=e.getReader();let o;for(;!(o=await n.read()).done;)t(o.value)},t.getLines=function(e){let t,n,o,r=!1;return function(a){void 0===t?(t=a,n=0,o=-1):t=function(e,t){const n=new Uint8Array(e.length+t.length);return n.set(e),n.set(t,e.length),n}(t,a);const c=t.length;let i=0;for(;n<c;){r&&(10===t[n]&&(i=++n),r=!1);let a=-1;for(;n<c&&-1===a;++n)switch(t[n]){case 58:-1===o&&(o=n-i);break;case 13:r=!0;case 10:a=n}if(-1===a)break;e(t.subarray(i,a),o),i=n,o=-1}i===c?t=void 0:0!==i&&(t=t.subarray(i),n-=i)}},t.getMessages=function(e,t,n){let o={data:"",event:"",id:"",retry:void 0},r=!1;const a=new TextDecoder;return function(c,i){if(0===c.length)null==n||n(o),o={data:"",event:"",id:"",retry:void 0},r=!1;else if(i>0){const n=a.decode(c.subarray(0,i)),s=i+1,d=a.decode(c.subarray(s));switch(n){case"data":o.data=r?o.data+"\n"+d:d,r=!0;break;case"event":o.event=d;break;case"id":e(o.id=d);break;case"retry":const n=parseInt(d,10);isNaN(n)||t(o.retry=n)}}}}},928:function(e,t,n){var o=this&&this.__rest||function(e,t){var n={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(n[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(o=Object.getOwnPropertySymbols(e);r<o.length;r++)t.indexOf(o[r])<0&&Object.prototype.propertyIsEnumerable.call(e,o[r])&&(n[o[r]]=e[o[r]])}return n};Object.defineProperty(t,"__esModule",{value:!0}),t.fetchEventSource=t.EventStreamContentType=void 0;const r=n(443);t.EventStreamContentType="text/event-stream";const a="last-event-id";function c(e){const n=e.headers.get("content-type");if(!(null==n?void 0:n.startsWith(t.EventStreamContentType)))throw new Error(`Expected content-type to be ${t.EventStreamContentType}, Actual: ${n}`)}t.fetchEventSource=function(e,n){var{signal:i,headers:s,onopen:d,onmessage:u,onclose:l,onerror:f,openWhenHidden:v,fetch:y}=n,p=o(n,["signal","headers","onopen","onmessage","onclose","onerror","openWhenHidden","fetch"]);return new Promise(((n,o)=>{const b=Object.assign({},s);let h;function g(){h.abort(),document.hidden||j()}b.accept||(b.accept=t.EventStreamContentType),v||document.addEventListener("visibilitychange",g);let m=1e3,w=0;function E(){document.removeEventListener("visibilitychange",g),window.clearTimeout(w),h.abort()}null==i||i.addEventListener("abort",(()=>{E(),n()}));const S=null!=y?y:window.fetch,O=null!=d?d:c;async function j(){var t;h=new AbortController;try{const t=await S(e,Object.assign(Object.assign({},p),{headers:b,signal:h.signal}));await O(t),await(0,r.getBytes)(t.body,(0,r.getLines)((0,r.getMessages)((e=>{e?b[a]=e:delete b[a]}),(e=>{m=e}),u))),null==l||l(),E(),n()}catch(e){if(!h.signal.aborted)try{const n=null!==(t=null==f?void 0:f(e))&&void 0!==t?t:m;window.clearTimeout(w),w=window.setTimeout(j,n)}catch(e){E(),o(e)}}}j()}))}}},t={};function n(o){var r=t[o];if(void 0!==r)return r.exports;var a=t[o]={exports:{}};return e[o].call(a.exports,a,a.exports,n),a.exports}var o={};return(()=>{var e=o;Object.defineProperty(e,"__esModule",{value:!0}),e.EventStreamContentType=e.fetchEventSource=void 0;const t=n(928);Object.defineProperty(e,"fetchEventSource",{enumerable:!0,get:function(){return t.fetchEventSource}}),Object.defineProperty(e,"EventStreamContentType",{enumerable:!0,get:function(){return t.EventStreamContentType}}),"undefined"!=typeof window&&window.document&&(window.FetchEventSource={fetchEventSource:t.fetchEventSource,EventStreamContentType:t.EventStreamContentType})})(),o})()));